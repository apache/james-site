<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_20) on Sun Sep 06 10:29:36 BST 2009 -->
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<TITLE>
ClamAVScan (Apache JAMES Standard Mailets 1.0-SNAPSHOT API)
</TITLE>

<META NAME="keywords" CONTENT="org.apache.james.transport.mailets.ClamAVScan class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="ClamAVScan (Apache JAMES Standard Mailets 1.0-SNAPSHOT API)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/ClamAVScan.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/apache/james/transport/mailets/AddSubjectPrefix.html" title="class in org.apache.james.transport.mailets"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/apache/james/transport/mailets/LogMessage.html" title="class in org.apache.james.transport.mailets"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/apache/james/transport/mailets/ClamAVScan.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="ClamAVScan.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.apache.james.transport.mailets</FONT>
<BR>
Class ClamAVScan</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html" title="class or interface in org.apache.mailet.base">org.apache.mailet.base.GenericMailet</A>
      <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>org.apache.james.transport.mailets.ClamAVScan</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mailet.html" title="class or interface in org.apache.mailet">Mailet</A>, <A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/MailetConfig.html" title="class or interface in org.apache.mailet">MailetConfig</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>ClamAVScan</B><DT>extends <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html" title="class or interface in org.apache.mailet.base">GenericMailet</A></DL>
</PRE>

<P>
<P>Does an antivirus scan check using a ClamAV daemon (CLAMD)</P>
 
 <P> Interacts directly with the daemon using the "stream" method,
 which should have the lowest possible overhead.</P>
 <P>The CLAMD daemon will typically reside on <I>localhost</I>, but could reside on a
 different host.
 It may also consist on a set of multiple daemons, each residing on a different
 server and on different IP number.
 In such case a DNS host name with multiple IP addresses (round-robin load sharing)
 is supported by the mailet (but on the same port number).</P>
 
 <P>Handles the following init parameters:</P>
 <UL>
    <LI><CODE>&lt;debug&gt;</CODE>.</LI>
    <LI><CODE>&lt;host&gt;</CODE>: the host name of the server where CLAMD runs. It can either be
        a machine name, such as
        "<code>java.sun.com</code>", or a textual representation of its
        IP address. If a literal IP address is supplied, only the
        validity of the address format is checked.
        If the machine name resolves to multiple IP addresses, <I>round-robin load sharing</I> will
        be used.
        The default is <CODE>localhost</CODE>.</LI>
    <LI><CODE>&lt;port&gt;</CODE>: the port on which CLAMD listens. The default is <I>3310</I>.</LI>
    <LI><CODE>&lt;maxPings&gt;</CODE>: the maximum number of connection retries during startup.
        If the value is <I>0</I> no startup test will be done.
        The default is <I>6</I>.</LI>
    <LI><CODE>&lt;pingIntervalMilli&gt;</CODE>: the interval (in milliseconds)
        between each connection retry during startup.
        The default is <I>30000</I> (30 seconds).</LI>
    <LI><CODE>&lt;streamBufferSize&gt;</CODE>: the BufferedOutputStream buffer size to use 
        writing to the <I>stream connection</I>. The default is <I>8192</I>.</LI>
 </UL>
 
 <P>The actions performed are as follows:</P>
 <UL>
    <LI>During initialization:</LI>
    <OL>
        <LI>Gets all <CODE>config.xml</CODE> parameters, handling the defaults;</LI>
        <LI>resolves the <CODE>&lt;host&gt;</CODE> parameter, creating the round-robin IP list;</LI>
        <LI>connects to CLAMD at the first IP in the round-robin list, on
            the specified <CODE>&lt;port&gt;</CODE>;</LI>
        <LI>if unsuccessful, retries every <CODE>&lt;pingIntervalMilli&gt;</CODE> milliseconds up to
            <CODE>&lt;maxPings&gt;</CODE> times;</LI>
        <LI>sends a <CODE>PING</CODE> request;</LI>
        <LI>waits for a <CODE>PONG</CODE> answer;</LI>
        <LI>repeats steps 3-6 for every other IP resolved.
    </OL>
    <LI>For every mail</LI>
    <OL>
        <LI>connects to CLAMD at the "next" IP in the round-robin list, on
            the specified <CODE>&lt;port&gt;</CODE>, and increments the "next" index;
            if the connection request is not accepted tries with the next one
            in the list unless all of them have failed;</LI>
        <LI>sends a "<CODE>STREAM</CODE>" request;</LI>
        <LI>parses the "<CODE>PORT <I>streamPort</I></CODE>" answer obtaining the port number;</LI>
        <LI>makes a second connection (the <I>stream connection</I>) to CLAMD at the same host (or IP)
            on the <I>streamPort</I> just obtained;</LI>
        <LI>sends the mime message to CLAMD (using <CODE>MimeMessage.writeTo(java.io.OutputStream)</CODE>)
            through the <I>stream connection</I>;</LI>
        <LI>closes the <I>stream connection</I>;</LI>
        <LI>gets the "<CODE>OK</CODE>" or "<CODE>... FOUND</CODE>" answer from the main connection;</LI>
        <LI>closes the main connection;</LI>
        <LI>sets the "<CODE>org.apache.james.infected</CODE>" <I>mail attribute</I> to either
            "<CODE>true</CODE>" or "<CODE>false</CODE>";</LI>
        <LI>adds the "<CODE>X-MessageIsInfected</CODE>" <I>header</I> to either
            "<CODE>true</CODE>" or "<CODE>false</CODE>";</LI>
    </OL>
 </UL>
 
 <P>Some notes regarding <a href="http://www.clamav.net/">clamav.conf</a>:</p>
 <UL>
    <LI><CODE>LocalSocket</CODE> must be commented out</LI>
    <LI><CODE>TCPSocket</CODE> must be set to a port# (typically 3310)</LI>
    <LI><CODE>StreamMaxLength</CODE> must be &gt;= the James config.xml parameter
    &lt;<CODE>maxmessagesize</CODE>&gt; in SMTP &lt;<CODE>handler</CODE>&gt;</LI>
    <LI><CODE>MaxThreads</CODE> should? be &gt;= the James config.xml parameter
    &lt;<CODE>threads</CODE>&gt; in &lt;<CODE>spoolmanager</CODE>&gt;</LI>
    <LI><CODE>ScanMail</CODE> must be uncommented</LI>
 </UL>

 <P>Here follows an example of config.xml definitions deploying CLAMD on localhost,
 and handling the infected messages:</P>
 <PRE><CODE>

 ...

    &lt;!-- Do an antivirus scan --&gt;
    &lt;mailet match="All" class="ClamAVScan" onMailetException="ignore"/&gt;

    &lt;!-- If infected go to virus processor --&gt;
    &lt;mailet match="HasMailAttributeWithValue=org.apache.james.infected, true" class="ToProcessor"&gt;
       &lt;processor&gt; virus &lt;/processor&gt;
    &lt;/mailet&gt;

    &lt;!-- Check attachment extensions for possible viruses --&gt;
    &lt;mailet match="AttachmentFileNameIs=-d -z *.exe *.com *.bat *.cmd *.pif *.scr *.vbs *.avi *.mp3 *.mpeg *.shs" class="ToProcessor"&gt;
       &lt;processor&gt; bad-extensions &lt;/processor&gt;
    &lt;/mailet&gt;

 ...

 &lt;!-- Messages containing viruses --&gt;
 &lt;processor name="virus"&gt;

    &lt;!-- To avoid a loop while bouncing --&gt;
    &lt;mailet match="All" class="SetMailAttribute"&gt;
       &lt;org.apache.james.infected&gt;true, bouncing&lt;/org.apache.james.infected&gt;
    &lt;/mailet&gt;

    &lt;mailet match="SMTPAuthSuccessful" class="Bounce"&gt;
       &lt;sender&gt;bounce-admin@xxx.com&lt;/sender&gt;
       &lt;inline&gt;heads&lt;/inline&gt;
       &lt;attachment&gt;none&lt;/attachment&gt;
       &lt;notice&gt; Warning: We were unable to deliver the message below because it was found infected by virus(es). &lt;/notice&gt;
    &lt;/mailet&gt;

    &lt;!--
    &lt;mailet match="All" class="ToRepository"&gt;
       &lt;repositoryPath&gt;file://var/mail/infected/&lt;/repositoryPath&gt;
    &lt;/mailet&gt;
    --&gt;

    &lt;mailet match="All" class="Null" /&gt;
 &lt;/processor&gt;
 </CODE></PRE>
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>2.2.1</DD>
<DT><B>Version:</B></DT>
  <DD>2.2.1</DD>
<DT><B>See Also:</B><DD><a href="http://www.clamav.net/">ClamAV Home Page</a>, 
<a href="http://www.sosdg.org/clamav-win32/">ClamAV For Windows</a></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#ClamAVScan()">ClamAVScan</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.net.InetAddress[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getAddresses()">getAddresses</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property addresses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.net.InetAddress</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getAddresses(int)">getAddresses</A></B>(int&nbsp;index)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indexed getter for property addresses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getAddressesCount()">getAddressesCount</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property addressesCount.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getAllowedInitParameters()">getAllowedInitParameters</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the expected init parameters.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.net.Socket</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getClamdSocket()">getClamdSocket</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets a Socket connected to CLAMD.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getHost()">getHost</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property host.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getMailetInfo()">getMailetInfo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return a string describing this mailet.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getMaxPings()">getMaxPings</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property maxPings.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.net.InetAddress</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getNextAddress()">getNextAddress</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property nextAddress.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getPingIntervalMilli()">getPingIntervalMilli</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property pingIntervalMilli.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getPort()">getPort</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property port.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getStreamBufferSize()">getStreamBufferSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property streamBufferSize.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#getStreamPortFromAnswer(java.lang.String)">getStreamPortFromAnswer</A></B>(java.lang.String&nbsp;answer)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses the answer from a STREAM request and gets the port number.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#init()">init</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mailet initialization routine.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#initDebug()">initDebug</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializer for property debug.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#initHost()">initHost</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializer for property host.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#initMaxPings()">initMaxPings</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializer for property maxPings.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#initPingIntervalMilli()">initPingIntervalMilli</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializer for property pingIntervalMilli.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#initPort()">initPort</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializer for property port.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#initStreamBufferSize()">initStreamBufferSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializer for property streamBufferSize.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#isDebug()">isDebug</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Getter for property debug.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#ping()">ping</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tries to "ping" all the CLAMD daemons to
 check if they are up and accepting requests.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#ping(java.net.InetAddress)">ping</A></B>(java.net.InetAddress&nbsp;address)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tries (and retries as specified up to 'getMaxPings()') to "ping" the specified CLAMD daemon to
 check if it is up and accepting requests.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#saveChanges(javax.mail.internet.MimeMessage)">saveChanges</A></B>(javax.mail.internet.MimeMessage&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Saves changes resetting the original message id.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#service(org.apache.mailet.Mail)">service</A></B>(<A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mail.html" title="class or interface in org.apache.mailet">Mail</A>&nbsp;mail)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scans the mail.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setAddresses(java.net.InetAddress[])">setAddresses</A></B>(java.net.InetAddress[]&nbsp;addresses)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property addresses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setDebug(boolean)">setDebug</A></B>(boolean&nbsp;debug)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property debug.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setHost(java.lang.String)">setHost</A></B>(java.lang.String&nbsp;host)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property host.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setMaxPings(int)">setMaxPings</A></B>(int&nbsp;maxPings)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property maxPings.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setPingIntervalMilli(int)">setPingIntervalMilli</A></B>(int&nbsp;pingIntervalMilli)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property pingIntervalMilli.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setPort(int)">setPort</A></B>(int&nbsp;port)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property port.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setStreamBufferSize(int)">setStreamBufferSize</A></B>(int&nbsp;streamBufferSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setter for property streamBufferSize.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_org.apache.mailet.base.GenericMailet"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class org.apache.mailet.base.<A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html" title="class or interface in org.apache.mailet.base">GenericMailet</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#arrayToString(java.lang.Object[])" title="class or interface in org.apache.mailet.base">arrayToString</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#checkInitParameters(java.lang.String[])" title="class or interface in org.apache.mailet.base">checkInitParameters</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#destroy()" title="class or interface in org.apache.mailet.base">destroy</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getInitParameter(java.lang.String)" title="class or interface in org.apache.mailet.base">getInitParameter</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getInitParameter(java.lang.String, boolean)" title="class or interface in org.apache.mailet.base">getInitParameter</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getInitParameter(java.lang.String, java.lang.String)" title="class or interface in org.apache.mailet.base">getInitParameter</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getInitParameterNames()" title="class or interface in org.apache.mailet.base">getInitParameterNames</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getMailetConfig()" title="class or interface in org.apache.mailet.base">getMailetConfig</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getMailetContext()" title="class or interface in org.apache.mailet.base">getMailetContext</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getMailetName()" title="class or interface in org.apache.mailet.base">getMailetName</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#init(org.apache.mailet.MailetConfig)" title="class or interface in org.apache.mailet.base">init</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#log(java.lang.String)" title="class or interface in org.apache.mailet.base">log</A>, <A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#log(java.lang.String, java.lang.Throwable)" title="class or interface in org.apache.mailet.base">log</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="ClamAVScan()"><!-- --></A><H3>
ClamAVScan</H3>
<PRE>
public <B>ClamAVScan</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getMailetInfo()"><!-- --></A><H3>
getMailetInfo</H3>
<PRE>
public java.lang.String <B>getMailetInfo</B>()</PRE>
<DL>
<DD>Return a string describing this mailet.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mailet.html#getMailetInfo()" title="class or interface in org.apache.mailet">getMailetInfo</A></CODE> in interface <CODE><A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mailet.html" title="class or interface in org.apache.mailet">Mailet</A></CODE><DT><B>Overrides:</B><DD><CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#getMailetInfo()" title="class or interface in org.apache.mailet.base">getMailetInfo</A></CODE> in class <CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html" title="class or interface in org.apache.mailet.base">GenericMailet</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>a string describing this mailet</DL>
</DD>
</DL>
<HR>

<A NAME="getAllowedInitParameters()"><!-- --></A><H3>
getAllowedInitParameters</H3>
<PRE>
protected java.lang.String[] <B>getAllowedInitParameters</B>()</PRE>
<DL>
<DD>Gets the expected init parameters.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="initDebug()"><!-- --></A><H3>
initDebug</H3>
<PRE>
protected void <B>initDebug</B>()</PRE>
<DL>
<DD>Initializer for property debug.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="isDebug()"><!-- --></A><H3>
isDebug</H3>
<PRE>
public boolean <B>isDebug</B>()</PRE>
<DL>
<DD>Getter for property debug.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property debug.</DL>
</DD>
</DL>
<HR>

<A NAME="setDebug(boolean)"><!-- --></A><H3>
setDebug</H3>
<PRE>
public void <B>setDebug</B>(boolean&nbsp;debug)</PRE>
<DL>
<DD>Setter for property debug.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>debug</CODE> - New value of property debug.</DL>
</DD>
</DL>
<HR>

<A NAME="initHost()"><!-- --></A><H3>
initHost</H3>
<PRE>
protected void <B>initHost</B>()
                 throws java.net.UnknownHostException</PRE>
<DL>
<DD>Initializer for property host.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.net.UnknownHostException</CODE> - if unable to resolve the host name, or if invalid</DL>
</DD>
</DL>
<HR>

<A NAME="getHost()"><!-- --></A><H3>
getHost</H3>
<PRE>
public java.lang.String <B>getHost</B>()</PRE>
<DL>
<DD>Getter for property host.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property host.</DL>
</DD>
</DL>
<HR>

<A NAME="setHost(java.lang.String)"><!-- --></A><H3>
setHost</H3>
<PRE>
public void <B>setHost</B>(java.lang.String&nbsp;host)
             throws java.net.UnknownHostException</PRE>
<DL>
<DD>Setter for property host.
 Resolves also the host name into the corresponding IP addresses, issues
 a <A HREF="../../../../../org/apache/james/transport/mailets/ClamAVScan.html#setAddresses(java.net.InetAddress[])"><CODE>setAddresses(java.net.InetAddress[])</CODE></A> and resets the <CODE>nextAddressIndex</CODE>
 variable to <I>0</I> for dealing with <I>round-robin</I>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>host</CODE> - New value of property host.
<DT><B>Throws:</B>
<DD><CODE>java.net.UnknownHostException</CODE> - if unable to resolve the host name, or if invalid</DL>
</DD>
</DL>
<HR>

<A NAME="initPort()"><!-- --></A><H3>
initPort</H3>
<PRE>
protected void <B>initPort</B>()</PRE>
<DL>
<DD>Initializer for property port.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getPort()"><!-- --></A><H3>
getPort</H3>
<PRE>
public int <B>getPort</B>()</PRE>
<DL>
<DD>Getter for property port.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property port.</DL>
</DD>
</DL>
<HR>

<A NAME="setPort(int)"><!-- --></A><H3>
setPort</H3>
<PRE>
public void <B>setPort</B>(int&nbsp;port)</PRE>
<DL>
<DD>Setter for property port.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>port</CODE> - New value of property port.</DL>
</DD>
</DL>
<HR>

<A NAME="initMaxPings()"><!-- --></A><H3>
initMaxPings</H3>
<PRE>
protected void <B>initMaxPings</B>()</PRE>
<DL>
<DD>Initializer for property maxPings.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getMaxPings()"><!-- --></A><H3>
getMaxPings</H3>
<PRE>
public int <B>getMaxPings</B>()</PRE>
<DL>
<DD>Getter for property maxPings.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property maxPings.</DL>
</DD>
</DL>
<HR>

<A NAME="setMaxPings(int)"><!-- --></A><H3>
setMaxPings</H3>
<PRE>
public void <B>setMaxPings</B>(int&nbsp;maxPings)</PRE>
<DL>
<DD>Setter for property maxPings.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>maxPings</CODE> - New value of property maxPings.</DL>
</DD>
</DL>
<HR>

<A NAME="initPingIntervalMilli()"><!-- --></A><H3>
initPingIntervalMilli</H3>
<PRE>
protected void <B>initPingIntervalMilli</B>()</PRE>
<DL>
<DD>Initializer for property pingIntervalMilli.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getPingIntervalMilli()"><!-- --></A><H3>
getPingIntervalMilli</H3>
<PRE>
public int <B>getPingIntervalMilli</B>()</PRE>
<DL>
<DD>Getter for property pingIntervalMilli.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property pingIntervalMilli.</DL>
</DD>
</DL>
<HR>

<A NAME="setPingIntervalMilli(int)"><!-- --></A><H3>
setPingIntervalMilli</H3>
<PRE>
public void <B>setPingIntervalMilli</B>(int&nbsp;pingIntervalMilli)</PRE>
<DL>
<DD>Setter for property pingIntervalMilli.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pingIntervalMilli</CODE> - New value of property pingIntervalMilli.</DL>
</DD>
</DL>
<HR>

<A NAME="initStreamBufferSize()"><!-- --></A><H3>
initStreamBufferSize</H3>
<PRE>
protected void <B>initStreamBufferSize</B>()</PRE>
<DL>
<DD>Initializer for property streamBufferSize.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getStreamBufferSize()"><!-- --></A><H3>
getStreamBufferSize</H3>
<PRE>
public int <B>getStreamBufferSize</B>()</PRE>
<DL>
<DD>Getter for property streamBufferSize.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property streamBufferSize.</DL>
</DD>
</DL>
<HR>

<A NAME="setStreamBufferSize(int)"><!-- --></A><H3>
setStreamBufferSize</H3>
<PRE>
public void <B>setStreamBufferSize</B>(int&nbsp;streamBufferSize)</PRE>
<DL>
<DD>Setter for property streamBufferSize.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>streamBufferSize</CODE> - New value of property streamBufferSize.</DL>
</DD>
</DL>
<HR>

<A NAME="getAddresses(int)"><!-- --></A><H3>
getAddresses</H3>
<PRE>
protected java.net.InetAddress <B>getAddresses</B>(int&nbsp;index)</PRE>
<DL>
<DD>Indexed getter for property addresses.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>index</CODE> - Index of the property.
<DT><B>Returns:</B><DD>Value of the property at <CODE>index</CODE>.</DL>
</DD>
</DL>
<HR>

<A NAME="getAddresses()"><!-- --></A><H3>
getAddresses</H3>
<PRE>
protected java.net.InetAddress[] <B>getAddresses</B>()</PRE>
<DL>
<DD>Getter for property addresses.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property addresses.</DL>
</DD>
</DL>
<HR>

<A NAME="setAddresses(java.net.InetAddress[])"><!-- --></A><H3>
setAddresses</H3>
<PRE>
protected void <B>setAddresses</B>(java.net.InetAddress[]&nbsp;addresses)</PRE>
<DL>
<DD>Setter for property addresses.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>addresses</CODE> - New value of property addresses.</DL>
</DD>
</DL>
<HR>

<A NAME="getNextAddress()"><!-- --></A><H3>
getNextAddress</H3>
<PRE>
protected java.net.InetAddress <B>getNextAddress</B>()</PRE>
<DL>
<DD>Getter for property nextAddress.
 
 Gets the address of the next CLAMD server to connect to in this round, using round-robin.
 Increments the nextAddressIndex for the next round.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property address.</DL>
</DD>
</DL>
<HR>

<A NAME="getAddressesCount()"><!-- --></A><H3>
getAddressesCount</H3>
<PRE>
public int <B>getAddressesCount</B>()</PRE>
<DL>
<DD>Getter for property addressesCount.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Value of property addressesCount.</DL>
</DD>
</DL>
<HR>

<A NAME="getClamdSocket()"><!-- --></A><H3>
getClamdSocket</H3>
<PRE>
protected java.net.Socket <B>getClamdSocket</B>()
                                  throws javax.mail.MessagingException</PRE>
<DL>
<DD>Gets a Socket connected to CLAMD.
 
 Will loop though the round-robin address list until the first one accepts
 the connection.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>a socket connected to CLAMD
<DT><B>Throws:</B>
<DD><CODE>javax.mail.MessagingException</CODE> - if no CLAMD in the round-robin address list has accepted the connection</DL>
</DD>
</DL>
<HR>

<A NAME="init()"><!-- --></A><H3>
init</H3>
<PRE>
public void <B>init</B>()
          throws javax.mail.MessagingException</PRE>
<DL>
<DD>Mailet initialization routine.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#init()" title="class or interface in org.apache.mailet.base">init</A></CODE> in class <CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html" title="class or interface in org.apache.mailet.base">GenericMailet</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>javax.mail.MessagingException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="service(org.apache.mailet.Mail)"><!-- --></A><H3>
service</H3>
<PRE>
public void <B>service</B>(<A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mail.html" title="class or interface in org.apache.mailet">Mail</A>&nbsp;mail)
             throws javax.mail.MessagingException</PRE>
<DL>
<DD>Scans the mail.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mailet.html#service(org.apache.mailet.Mail)" title="class or interface in org.apache.mailet">service</A></CODE> in interface <CODE><A HREF="http://james.apache.org/mailet/api//apidocs/org/apache/mailet/Mailet.html" title="class or interface in org.apache.mailet">Mailet</A></CODE><DT><B>Specified by:</B><DD><CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html#service(org.apache.mailet.Mail)" title="class or interface in org.apache.mailet.base">service</A></CODE> in class <CODE><A HREF="http://james.apache.org/mailet/base//apidocs/org/apache/mailet/base/GenericMailet.html" title="class or interface in org.apache.mailet.base">GenericMailet</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>mail</CODE> - the mail to scan
<DT><B>Throws:</B>
<DD><CODE>javax.mail.MessagingException</CODE> - if a problem arises</DL>
</DD>
</DL>
<HR>

<A NAME="ping()"><!-- --></A><H3>
ping</H3>
<PRE>
protected void <B>ping</B>()
             throws java.lang.Exception</PRE>
<DL>
<DD>Tries to "ping" all the CLAMD daemons to
 check if they are up and accepting requests.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="ping(java.net.InetAddress)"><!-- --></A><H3>
ping</H3>
<PRE>
protected void <B>ping</B>(java.net.InetAddress&nbsp;address)
             throws java.lang.Exception</PRE>
<DL>
<DD>Tries (and retries as specified up to 'getMaxPings()') to "ping" the specified CLAMD daemon to
 check if it is up and accepting requests.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>address</CODE> - the address to "ping"
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getStreamPortFromAnswer(java.lang.String)"><!-- --></A><H3>
getStreamPortFromAnswer</H3>
<PRE>
protected final int <B>getStreamPortFromAnswer</B>(java.lang.String&nbsp;answer)
                                     throws java.net.ConnectException</PRE>
<DL>
<DD>Parses the answer from a STREAM request and gets the port number.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>answer</CODE> - the answer from CLAMD containing the port number
<DT><B>Returns:</B><DD>the port number for streaming out the data to scan
<DT><B>Throws:</B>
<DD><CODE>java.net.ConnectException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="saveChanges(javax.mail.internet.MimeMessage)"><!-- --></A><H3>
saveChanges</H3>
<PRE>
protected final void <B>saveChanges</B>(javax.mail.internet.MimeMessage&nbsp;message)
                          throws javax.mail.MessagingException</PRE>
<DL>
<DD>Saves changes resetting the original message id.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to save
<DT><B>Throws:</B>
<DD><CODE>javax.mail.MessagingException</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/ClamAVScan.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/apache/james/transport/mailets/AddSubjectPrefix.html" title="class in org.apache.james.transport.mailets"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/apache/james/transport/mailets/LogMessage.html" title="class in org.apache.james.transport.mailets"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/apache/james/transport/mailets/ClamAVScan.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="ClamAVScan.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2008-2009 <a href="http://www.apache.org">The Apache Software Foundation</a>. All Rights Reserved.
</BODY>
</HTML>
