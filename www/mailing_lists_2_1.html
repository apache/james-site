<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Apache James - Mail and News server - James 2.1 - Creating Mailing Lists</title>
<LINK TITLE="Style" HREF="stylesheet.css" TYPE="text/css" REL="stylesheet" />
</head>
<body>
<table cellspacing="0" width="100%" border="0" class="page-header">
<!--PAGE HEADER-->
<tr>
<td colspan="2">
<!--ASF LOGO-->
<a href="http://www.apache.org/">
<img border="0" alt="The ASF" align="left" src="http://www.apache.org/images/asf_logo_wide.gif" />
</a>
<!--PROJECT LOGO-->
<a href="http://james.apache.org/">
<img border="0" alt="James - Java Apache Mail Enterprise Server" align="right" src="http://james.apache.org//images/james-logo.jpg" />
</a>
</td>
</tr>
</table>
<table cellspacing="4" width="100%" border="0">
<tr>
<!--LEFT SIDE NAVIGATION-->
<td nowrap="true" valign="top" class="left-navbar">
<a href="http://apachecon.com">
<img border="0" alt="ApacheCon Promotion" align="left" src="http://apache.org/images/ac2005eu_135x50.gif" />
</a>
<br />
<br />
<navbar name="lhs">
      <p>
<strong>James</strong>
</p>
<ul>
<li>
<a href="./index.html">Overview</a>
</li>
<li>
<a href="./FAQ.html">James FAQ</a>
</li>
<li>
<a href="./mail.html">Mailing Lists</a>
</li>
<li>
<a href="http://wiki.apache.org/james">Wiki</a>
</li>
</ul>
      <p>
<strong>Downloads</strong>
</p>
<ul>
<li>
<a href="http://james.apache.org/download.cgi">Releases</a>
</li>
</ul>
      <p>
<strong>Documentation</strong>
</p>
<ul>
<li>
<a href="./documentation_2_1.html">James 2.X</a>
</li>
<li>
<a href="./design_objectives.html">Design</a>
</li>
<li>
<a href="./javadocs/index.html">James Javadocs</a>
</li>
<li>
<a href="./mailet/index.html">Mailet Javadocs</a>
</li>
<li>
<a href="./rfclist.html">Useful RFCs</a>
</li>
<li>
<a href="./document_archive.html">Document Archive</a>
</li>
</ul>
    </navbar>
</td>
<!--MAIN BODY-->
<td align="left" valign="top" class="main-body">
<div class="section">
<div class="section-header">
<a name="How To Create Mailing Lists">
<strong>How To Create Mailing Lists</strong>
</a>
</div>
<p>
<div class="section-body">
<p>One of the frequent questions on the James-User Mailing List is how
to create a mailing list. This document explains one way of using the
currently supplied Matchers and Mailets in James v2.1.</p>

<p>Basically, the process requires creating two &lt;mailet&gt; entries
and a repository.  The first mailet handles list commands (currently
only <i>list-name</i>-on and <i>list-name</i>-off).  The second mailet
handles list messages.  The repository will hold the e-mail addresses
of list subscribers.</p>

<p>The mailets go into the processor chain (e.g., at the top of the
<i>transport</i> processor), the repository goes into the
&lt;users-store&gt; block.</p>

<div class="subsection">
<div class="subsection-header">
<a name="Setting up the Mailets">
<strong>Setting up the Mailets</strong>
</a>
</div>
<div class="subsection-body">

<p>You need to setup two mailets.</p>

<p>The first mailet that you need to setup is an instance of the <a href="provided_mailets_2_1.html#AvalonListservManager">Avalon Listserv
Manager</a> mailet.  This will handle subscribing and unsubscribing.
[Note: the current code does not support confirmed opt-in, just basic
commands.]  The <a href="provided_matchers_2_1.html#CommandForListserv">CommandForListserv</a>
matcher is used to invoke match messages containing commands for the
mailing list.</p>

<p>The second mailet is an instance of the <a href="provided_mailets_2_1.html#AvalonListserv">Avalon Listserv</a>
mailet.  That mailet actually receives messages for the list and
causes them to be distributed.  The <a href="provided_matchers_2_1.html#RecipientIs">RecipientIs</a> matcher
is used to match messages intended for the mailing list.</p>

<p>The following illustrates the two &lt;mailet&gt; elements that need to be added:</p>

<div class="source">
  &lt;mailet match="CommandForListserv=list-name@domain"
          class="AvalonListservManager"&gt;
    &lt;repositoryName&gt;list-name&lt;/repositoryName&gt;
  &lt;/mailet&gt;

  &lt;mailet match="RecipientIs=list-name@domain" class="AvalonListserv"&gt;
    &lt;repositoryName&gt;list-name&lt;/repositoryName&gt;
    ... list options ...
  &lt;/mailet&gt;
</div>

</div>
</div>

<div class="subsection">
<div class="subsection-header">
<a name="Setting up the Repository">
<strong>Setting up the Repository</strong>
</a>
</div>
<div class="subsection-body">

<p>The mailing list mailets need a repository within which to store
the subscriber list.  There is a separate repository for each mailing
list, and is completely independent of the user repository used by
James to manage e-mail accounts.  This is configured in the
&lt;users-store&gt; block of config.xml.</p>

<p>The following illustrates a database-backed repository using JDBC
with the ListUsersJdbcRepository class.  Notice that there will be a
single table, <i>lists</i>, created in the db://maildb resource
defined elsewhere.  There are currently two columns: the list name and
the list subscriber.</p>

<div class="source">
  &lt;repository name="list-name"
                 class="org.apache.james.userrepository.ListUsersJdbcRepository"
                 destinationURL="db://maildb/lists/list-name"&gt;
    &lt;sqlFile&gt;file://conf/sqlResources.xml&lt;/sqlFile&gt;
  &lt;/repository&gt;
</div>

<p>The following illustrates a file-system repository using the
UsersFileRepository class. [Note: the destination URL is a child
element when configuring a file-system repository, and an attribute
when configuring a database-backed repository.  This inconsistency
will be addressed in a future version of James.]</p>

<div class="source">
  &lt;repository name="list-name"
                 class="org.apache.james.userrepository.UsersFileRepository"&gt;
    &lt;destination URL="file://var/lists/list-name/" /&gt; 
  &lt;/repository&gt;
</div>

</div>
</div>
</div>
</p>
</div>
</td>
<!--RIGHT SIDE NAVIGATION-->
<td nowrap="true" valign="top" class="right-navbar">
<navbar name="rhs">
      <p>
<strong>Project</strong>
</p>
<ul>
<li>
<a href="http://issues.apache.org/jira/browse/JAMES">Bug Database </a>
</li>
<li>
<a href="http://svn.apache.org/">Source Code</a>
</li>
<li>
<a href="./weare.html">Who We Are</a>
</li>
<li>
<a href="./contribute.html">Contributing</a>
</li>
<li>
<a href="./code-standards.html">Standards</a>
</li>
<li>
<a href="./license.html">License</a>
</li>
<li>
<a href="./changelog.html">Changelog</a>
</li>
<li>
<a href="./todo.html">TODO</a>
</li>
</ul>
      <p>
<strong>Translated</strong>
</p>
<ul>
<li>
<a href="http://james.terra-intl.com/">Japanese (web)</a>
</li>
</ul>
      <p>
<strong>Related Projects</strong>
</p>
<ul>
<li>
<a href="http://jakarta.apache.org/index.html">Jakarta</a>
</li>
<li>
<a href="http://ant.apache.org/index.html">Ant</a>
</li>
<li>
<a href="http://avalon.apache.org/index.html">Avalon</a>
</li>
</ul>
      <p>
<strong>Useful Information</strong>
</p>
<ul>
<li>
<a href="http://jakarta.apache.org/site/getinvolved.html">Get Involved</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/library.html">Reference Library</a>
</li>
<li>
<a href="http://apache.org/foundation/faq.html">Apache</a>
</li>
</ul>
    </navbar>
</td>
</tr>
<!--FOOTER SEPARATOR-->
<tr>
<td colspan="3">
<hr size="1" noshade="" />
</td>
</tr>
<tr>
<td colspan="3">
<div class="page-footer">
<em>
        Copyright &copy; 1999-2005, The Apache Software Foundation
        </em>
</div>
</td>
</tr>
</table>
</body>
</html>
