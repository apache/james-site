<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Simple Mail Transfer Protocol (SMTP) :: Apache James</title>
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://james.apache.org">Apache James</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="james-project" data-version="3.5">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Apache James Server</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Concepts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/index.html">User Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../messages/index.html">Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../messages/imf.html">IMF</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../messages/mime.html">MIME</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Protocols</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="smtp.html">SMTP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pop.html">POP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="imap.html">IMAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="jmap.html">JMAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="esmtp.html">ESMTP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lmtp.html">LMTP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/index.html">Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processing/index.html">Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../servers/index.html">Servers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../servers/demo.html">Demo</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servers/5-minute-demo.html">Short Demo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servers/15-minute-demo.html">Long Demo</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servers/local.html">Local</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servers/redundant.html">Redundant</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../servers/distributed.html">Distributed</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servers/distributed/architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servers/distributed/run.html">Run</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servers/distributed/run-docker.html">Run with docker</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servers/distributed/configure/index.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../servers/distributed/operate/index.html">Operate the Distributed server</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/operate/guide.html">Operator guide</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/operate/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/operate/webadmin.html">WebAdmin REST administration API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/operate/metrics.html">Metrics</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/operate/cli.html">Command Line Interface</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../servers/distributed/extend/index.html">Extending the behavior of the Distributed Server</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/extend/mail-processing.html">Custom mail processing components</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/extend/mailbox-listeners.html">Custom Mailbox Listeners</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/extend/smtp-hooks.html">Custom SMTP hooks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../servers/distributed/extend/webadmin-routes.html">Custom WebAdmin routes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../customization/index.html">Customization</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../development/index.html">Developer Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../community/index.html">Community</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Apache James Server</span>
    <span class="version">3.5</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Apache James JDKIM</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../jdkim/0.3-SNAPSHOT/index.html">0.3-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apache James jSieve</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../jsieve/0.8-SNAPSHOT/index.html">0.8-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apache James jSPF</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../jspf/1.0.2-SNAPSHOT/index.html">1.0.2-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apache James Mime4j</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../mime4j/0.8.4-SNAPSHOT/index.html">0.8.4-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apache James Postage</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../postage/0.1-SNAPSHOT/index.html">0.1-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Apache James Server</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">3.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apache James Site</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../james-site/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../james-site/latest/homepage.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Apache James Server</a></li>
    <li><a href="../index.html">Concepts</a></li>
    <li><a href="index.html">Protocols</a></li>
    <li><a href="smtp.html">SMTP</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://gitbox.apache.org/repos/asf/james-project/blob/master/docs/modules/concepts/pages/protocols/smtp.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Simple Mail Transfer Protocol (SMTP)</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the original specification for Simple Mail Transfer Protocol, or SMTP,
was published almost 40 years ago together with
<a href="../messages/imf.html" class="page">IMF</a>, email as we know it today was born.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifications"><a class="anchor" href="#_specifications"></a>Specifications</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_rfc821"><a class="anchor" href="#_rfc821"></a>RFC821</h3>
<div class="paragraph">
<p><a href="https://tools.ietf.org/html/rfc821">RFC821</a> ("Simple Mail Transfer Protocol")
was the original SMTP specification published in 1982.
It was obsoleted by <a href="#_rfc2821">RFC2821</a> in 2001.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rfc2821"><a class="anchor" href="#_rfc2821"></a>RFC2821</h3>
<div class="paragraph">
<p><a href="https://tools.ietf.org/html/rfc2821">RFC2821</a> ("Simple Mail Transfer Protocol") replaced
<a href="#_rfc821">RFC821</a>. It was itself replaced by <a href="#RFC5321">[RFC5321]</a> in 2008.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rfc_5321"><a class="anchor" href="#_rfc_5321"></a>RFC 5321</h3>
<div class="paragraph">
<p><a href="https://tools.ietf.org/html/rfc5321">RFC5321</a> is the currently used standard for
"Simple Mail Transfer Protocol", or "SMTP". Published in 2008, it is "a specification of the basic
protocol for Internet electronic mail transport". If you are interested in all
the gory details, we recommend that you read this document.</p>
</div>
<div class="paragraph">
<p>This specification has many dependencies with <a href="../messages/imf.html" class="page">IMF</a>,
<a href="../messages/mime.html" class="page">MIME</a>, and other technical concepts, which can quickly
become utterly confusing.
Here, we provide a very short and simplified description of those portions of the
specification that we felt were interesting enough to repeat here.</p>
</div>
<div class="paragraph">
<p>As the spec mentions, "SMTP transports a mail object",  a mail object being described
as an object that contains both an envelope and content. An SMTP client connects
to a server and communicates via a session. Both client and server provide a
mail transport service, and are therefore act as "Mail Transfer Agents", or
"MTAs". A mail originates and terminates with a "Mail User Agent" ("MUA").
On the originating side, a MUA may, for instance, collect mail to be transmitted
by a user and hand it off to an MTA. On the terminating side, an MTA would
hand a mail off to an MUA.</p>
</div>
<div class="paragraph">
<p>"SMTP sessions are stateful, with both parties carefully maintaining a
common view of the current state." The session is initiated by the client,
which establishes a two-way channel to an SMTP server. The session must either
close successful (or with a failure message), else delivery is considered to
have failed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_related_concepts"><a class="anchor" href="#_related_concepts"></a>Related Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SMTP relates to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="../messages/index.html" class="page">Email messages</a></strong>, in that the SMTP protocol exists to transfer
messages from one host to another</p>
</li>
<li>
<p><strong><a href="../glossary.html#mta" class="page">MTA</a></strong>, in that the very nature of SMTP is about specifying how a message
gets transferred from one MTA to another</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_try_it"><a class="anchor" href="#_try_it"></a>Try It!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can try speaking SMTP with your demo server by connecting to it using telnet. It would not work on a real world server as it would requires encrypted traffic. See "using openssl to talk to your server"</p>
</div>
<div class="paragraph">
<p>Requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run the long demo (without stopping)</p>
</li>
<li>
<p>Telnet</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Approximate duration: 5 minutes</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Note: extra lines are inserted below to help show you what you need to type.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-telnet hljs" data-lang="telnet">$ telnet 127.0.0.1 25 <i class="conum" data-value="1"></i><b>(1)</b>

Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 JAMES Linagora's SMTP awesome Server

ehlo test <i class="conum" data-value="2"></i><b>(2)</b>

250-9a2fe463e592 Hello test [172.17.0.1])
250-PIPELINING
250-ENHANCEDSTATUSCODES
250 8BITMIME

mail from: &lt;user02@james.local&gt; <i class="conum" data-value="3"></i><b>(3)</b>

250 2.1.0 Sender &lt;user02@james.local&gt; OK

rcpt to: &lt;user01@james.local&gt; <i class="conum" data-value="4"></i><b>(4)</b>

250 2.1.5 Recipient &lt;user01@james.local&gt; OK

data <i class="conum" data-value="5"></i><b>(5)</b>

354 Ok Send data ending with &lt;CRLF&gt;.&lt;CRLF&gt;

Subject: Test Message <i class="conum" data-value="5"></i><b>(5)</b>
<i class="conum" data-value="6"></i><b>(6)</b>
This is just a test. <i class="conum" data-value="7"></i><b>(7)</b>
. <i class="conum" data-value="8"></i><b>(8)</b>

250 2.6.0 Message received

quit <i class="conum" data-value="9"></i><b>(9)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Connect to the James server using the SMTP protocol via telnet.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Initiate the SMTP session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Indicate that you want to send a mail from user02@james.local.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Indicate that the mail should be sent to user01@james.local.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Enter the subject.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Enter a blank line.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Enter some text. You can enter multiples lines if you like.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>When you have completed the message, enter a line with only a "." and no other text.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>End the session.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you set up Thunderbird to connect to the server, you can confirm that the mail
has indeed arrived in the mailbox of user01@james.local.</p>
</div>
<div class="paragraph">
<p>Pretty cool! Good thing we have James so we don&#8217;t have to always send emails manually.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>