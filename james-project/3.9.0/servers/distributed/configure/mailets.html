<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Distributed James Server &mdash; Mailets :: Apache James</title>
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://james.apache.org"><img src="/_/img/james.svg" alt="james logo"> Apache James</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>James server</strong></div>
            <a class="navbar-item" href="https://github.com/apache/james-project">Repository</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/projects/JAMES/issues">Issue Tracker</a>
            <hr class="navbar-divider">
            <a class="navbar-item" href="https://james.apache.org/mime4j/index.html">Mime4J</a>
            <a class="navbar-item" href="https://james.apache.org/jsieve/index.html">jSieve</a>
            <a class="navbar-item" href="https://james.apache.org/jspf/index.html">jSPF</a>
            <a class="navbar-item" href="https://james.apache.org/jdkim/index.html">jDKIM</a>
            <a class="navbar-item" href="https://james.apache.org/hupa/index.html">HUPA</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
             <!-- Not ideal but dropping the version in the href requires tweaking james-projet docs module first -->
            <a class="navbar-item" href="/james-project/3.6.0/community/mailing-lists.html">Mailing lists</a>
            <a class="navbar-item" href="https://gitter.im/apache/james-project"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="logo-gitter-sign" data-v-44ebcb1a=""><rect x="15" y="5" width="2" height="10"></rect> <rect x="10" y="5" width="2" height="20"></rect> <rect x="5" y="5" width="2" height="20"></rect> <rect width="2" height="15"></rect></svg> Gitter</a>
            <a class="navbar-item" href="https://twitter.com/ApacheJames">
              <span class="icon">
                <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                  <path fill="#57aaee" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
                </svg>
              </span> Twitter
            </a>            
            <a class="navbar-item" href="#">  <svg class="octicon octicon-mark-github v-align-middle" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg> Github</a>
          </div>
        </div>
<!--        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="james-project" data-version="3.9.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../../index.html">Apache James Server</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../concepts/index.html">Concepts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../concepts/user/index.html">User Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../concepts/mail/index.html">Emails</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../concepts/messages/index.html">Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../concepts/messages/imf.html">IMF</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../../concepts/messages/mime.html">MIME</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../concepts/protocols/index.html">Protocols</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/protocols/smtp.html">SMTP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/protocols/pop.html">POP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/protocols/imap.html">IMAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/protocols/jmap.html">JMAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/protocols/esmtp.html">ESMTP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/protocols/lmtp.html">LMTP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../concepts/storage/index.html">Storage</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/storage/mailbox.html">Mailboxes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../concepts/storage/users.html">Users</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../concepts/processing/index.html">Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../concepts/configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../concepts/glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">Servers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../demo.html">Demo</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../5-minute-demo.html">Short Demo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../15-minute-demo.html">Long Demo</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../basic/index.html">Basic</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../basic/context.html">Context</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../basic/objectives.html">Objectives</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../basic/concepts.html">Concepts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../basic/architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../basic/conf/index.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../basic/help.html">Help</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Distributed James Application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../objectives.html">Objectives and motivation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../architecture/index.html">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/implemented-standards.html">Implemented standards</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/consistency-model.html">Consistency Model</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/specialized-instances.html">Specialized instances</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../run/index.html">Run</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../run/run-java.html">Run with Java</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../run/run-docker.html">Run with Docker</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../run/run-kubernetes.html">Run with Kubernetes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../run/k8s-checklist.html">Deployment Checklist</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../run/k8s-logsMetrics.html">Logs &amp; Metrics</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../run/k8s-values.html">values.yaml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../run/k8s-secrets.html">secrets.yaml</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Protocols</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="imap.html">imapserver.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="jmap.html">jmap.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="jmx.html">jmx.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="smtp.html">smtpserver.xml &amp; lmtpserver.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="smtp-hooks.html">Packaged SMTP hooks</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="pop3.html">pop3server.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="webadmin.html">webadmin.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="ssl.html">SSL &amp; TLS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="sieve.html">Sieve &amp; ManageSieve</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Storage dependencies</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="blobstore.html">blobstore.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="cassandra.html">cassandra.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="opensearch.html">opensearch.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="rabbitmq.html">rabbitmq.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="redis.html">redis.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="tika.html">tika.properties</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Core components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="batchsizes.html">batchsizes.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="dns.html">dnsservice.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="domainlist.html">domainlist.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="droplists.html">DropLists</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="healthcheck.html">healthcheck.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="mailetcontainer.html">mailetcontainer.xml</a>
  </li>
  <li class="nav-item is-current-page" data-depth="5">
    <a class="nav-link" href="mailets.html">Packaged Mailets</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="matchers.html">Packaged Matchers</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="mailrepositorystore.html">mailrepositorystore.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="recipientrewritetable.html">recipientrewritetable.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="search.html">search.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="usersrepository.html">usersrepository.xml</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extensions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="vault.html">deletedMessageVault.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="extensions.html">extensions.properties</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="listeners.html">listeners.xml</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="spam.html">Anti-Spam setup</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="remote-delivery-error-handling.html">About RemoteDelivery error handling</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="collecting-contacts.html">Contact collection</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="collecting-events.html">Event collection</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="dsn.html">ESMTP DSN support</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../operate/index.html">Operate</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/guide.html">Operator guide</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/performanceChecklist.html">Performance checklist</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/webadmin.html">WebAdmin REST administration API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/metrics.html">Metrics</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/migrating.html">Migrating existing data</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/cli.html">Command Line Interface</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/cassandra-migration.html">Cassandra migration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../operate/security.html">Security checklist</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../extending.html">Extending behaviour</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../benchmark/index.html">Performance benchmark</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../benchmark/db-benchmark.html">Database benchmarks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../benchmark/james-benchmark.html">James benchmarks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../test.html">Test</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../customization/index.html">Extending server behavior</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../customization/mail-processing.html">Custom mail processing components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../customization/mailbox-listeners.html">Custom Mailbox Listeners</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../customization/smtp-hooks.html">Custom SMTP hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../customization/webadmin-routes.html">Custom WebAdmin routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../customization/imap.html">Custom IMAP processing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../development/index.html">Developer Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../development/logging.html">Logging in Apache James</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../community/index.html">Community</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/mailing-lists.html">Mailing lists</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/contributing.html">Contributing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/guidelines.html">Guidelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/download.html">Download releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/website.html">Building and publishing the website</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/release.html">Creating an official Apache James release</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../community/support.html">Professional support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Apache Software Foundation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/">ASF</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/foundation/getinvolved.html">Get involved</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/foundation/faq.html">FAQ</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/licenses/">Licenses</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/security/">Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Apache James Server</span>
    <span class="version">3.9.0 SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../../../james-distributed-app/3.8.1/index.html">Apache James Distributed Server</a></div>
      <ul class="versions">
        <li class="version">
          <a href="../../../../../james-distributed-app/3.9.0/index.html">3.9.0 SNAPSHOT</a>
        </li>
        <li class="version is-latest">
          <a href="../../../../../james-distributed-app/3.8.1/index.html">3.8.1</a>
        </li>
        <li class="version">
          <a href="../../../../../james-distributed-app/3.7.5/index.html">3.7.5</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../../../../3.8.1/index.html">Apache James Server</a></div>
      <ul class="versions">
        <li class="version is-current">
          <a href="../../../index.html">3.9.0 SNAPSHOT</a>
        </li>
        <li class="version is-latest">
          <a href="../../../../3.8.1/index.html">3.8.1</a>
        </li>
        <li class="version">
          <a href="../../../../3.7.5/index.html">3.7.5</a>
        </li>
        <li class="version">
          <a href="../../../../3.6.0/index.html">3.6.0 Snapshot</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../../james-site/latest/index.html">Apache James Site</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../james-site/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../james-site/latest/homepage.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Apache James Server</a></li>
    <li><a href="../../index.html">Servers</a></li>
    <li><a href="../index.html">Distributed James Application</a></li>
    <li><a href="index.html">Configuration</a></li>
    <li>Core components</li>
    <li><a href="mailets.html">Packaged Mailets</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">3.9.0 SNAPSHOT</button>
  <div class="version-menu">
    <a class="version is-current" href="mailets.html">3.9.0 SNAPSHOT</a>
    <a class="version is-missing" href="../../../../3.8.1/index.html">3.8.1</a>
    <a class="version is-missing" href="../../../../3.7.5/index.html">3.7.5</a>
    <a class="version" href="../../../../3.6.0/servers/distributed/configure/mailets.html">3.6.0 Snapshot</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/apache/james-project/blob/master/docs/modules/servers/pages/distributed/configure/mailets.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Distributed James Server &mdash; Mailets</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This documentation page lists and documents Mailet that can be used within the
Distributed Server MailetContainer in order to write your own mail processing logic with out-of-the-box components.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supported_mailets"><a class="anchor" href="#_supported_mailets"></a>Supported mailets</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_adddeliveredtoheader"><a class="anchor" href="#_adddeliveredtoheader"></a>AddDeliveredToHeader</h3>
<div class="paragraph">
<p>This mailet adds the de-facto standard QMail Delivered-To header.</p>
</div>
<div class="paragraph">
<p>Upon processing by LocalDelivery, a Delivered-To header matching the recipient mail address will be added before storage.</p>
</div>
<div class="paragraph">
<p>Example</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="AddDeliveredToHeader"&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_addfooter"><a class="anchor" href="#_addfooter"></a>AddFooter</h3>
<div class="paragraph">
<p>Takes the message and attaches a footer message to it.  Right now, it only
supports simple messages.  Needs to have additions to make it support
messages with alternate content types or with attachments.</p>
</div>
</div>
<div class="sect2">
<h3 id="_addsubjectprefix"><a class="anchor" href="#_addsubjectprefix"></a>AddSubjectPrefix</h3>
<div class="paragraph">
<p>Add an prefix (tag) to the subject of a message &lt;br&gt;</p>
</div>
<div class="paragraph">
<p>Sample Configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="RecipientIs=robot@james.apache.org" class="TagMessage"&gt;
  &lt;subjectPrefix&gt;[robot]&lt;/subjectPrefix&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_amqpforwardattribute"><a class="anchor" href="#_amqpforwardattribute"></a>AmqpForwardAttribute</h3>
<div class="paragraph">
<p>This mailet forwards the attributes values to a AMPQ.</p>
</div>
<div class="paragraph">
<p>It takes 4 parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>attribute (mandatory): content to be forwarded, expected to be a Map&lt;String, byte[]&gt;
where the byte[] content is issued from a MimeBodyPart.
It is typically generated from the StripAttachment mailet.</p>
</li>
<li>
<p>uri (mandatory): AMQP URI defining the server where to send the attachment.</p>
</li>
<li>
<p>exchange (mandatory): name of the AMQP exchange.</p>
</li>
<li>
<p>routing_key (optional, default to empty string): name of the routing key on this exchange.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This mailet will sent the data attached to the mail as an attribute holding a map.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bounce"><a class="anchor" href="#_bounce"></a>Bounce</h3>
<div class="paragraph">
<p>Generates a response to the reverse-path address. Note that this is different
than a mail-client&#8217;s reply, which would use the Reply-To or From header.</p>
</div>
<div class="paragraph">
<p>Bounced messages are attached in their entirety (headers and content) and the
resulting MIME part type is "message/rfc822".</p>
</div>
<div class="paragraph">
<p>The reverse-path and the Return-Path header of the response is set to "null"
("&lt;&gt;"), meaning that no reply should be sent.</p>
</div>
<div class="paragraph">
<p>A sender of the notification message can optionally be specified. If one is
not specified, the postmaster&#8217;s address will be used.</p>
</div>
<div class="paragraph">
<p>A notice text can be specified, and in such case will be inserted into the
notification inline text.</p>
</div>
<div class="paragraph">
<p>If the notified message has an "error message" set, it will be inserted into
the notification inline text. If the <strong>attachError</strong> init
parameter is set to true, such error message will be attached to the
notification message.</p>
</div>
<div class="paragraph">
<p>Supports the <strong>passThrough</strong> init parameter (true if missing).</p>
</div>
<div class="paragraph">
<p>Sample configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="Bounce"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered, default=postmaster*&lt;/sender&gt;
  &lt;attachError&gt;*true or false, default=false*&lt;/attachError&gt;
  &lt;message&gt;*notice attached to the original message text (optional)*&lt;/message&gt;
  &lt;prefix&gt;*optional subject prefix prepended to the original message*&lt;/prefix&gt;
  &lt;inline&gt;*default=none*&lt;/inline&gt;
  &lt;attachment&gt;*default=message*&lt;/attachment&gt;
  &lt;passThrough&gt;*true or false, default=true*&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false, default=true*&lt;/fakeDomainCheck&gt;
  &lt;debug&gt;*true or false, default=false*&lt;/debug&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The behaviour of this mailet is equivalent to using Resend with the following
configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="Resend"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered*&lt;/sender&gt;
  &lt;attachError&gt;*true or false*&lt;/attachError&gt;
  &lt;message&gt;**dynamically built**&lt;/message&gt;
  &lt;prefix&gt;*a string*&lt;/prefix&gt;
  &lt;passThrough&gt;true or false&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false*&lt;/fakeDomainCheck&gt;
  &lt;recipients&gt;*sender*&lt;/recipients&gt;
  &lt;reversePath&gt;null&lt;/reversePath&gt;
  &lt;inline&gt;see Resend&lt;/inline&gt;
  &lt;attachment&gt;see Resend&lt;/attachment&gt;
  &lt;isReply&gt;true&lt;/isReply&gt;
  &lt;debug&gt;*true or false*&lt;/debug&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><strong>notice</strong> and <strong>sendingAddress</strong> can be used instead of <strong>message</strong>
and <strong>sender</strong>; such names are kept for backward compatibility.</p>
</div>
</div>
<div class="sect2">
<h3 id="_contactextractor"><a class="anchor" href="#_contactextractor"></a>ContactExtractor</h3>
<div class="paragraph">
<p>Collects the sender and the recipients of a message and store them as JSON in a
specified message attribute.</p>
</div>
<div class="paragraph">
<p>Here is the JSON format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "userEmail" : "sender@james.org",
  "emails" : [ "to@james.org", "cc@james.org" ]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Sample configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="ContactExtractor"&gt;
  &lt;attribute&gt;ExtractedContacts&lt;/attribute&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_convertto7bit"><a class="anchor" href="#_convertto7bit"></a>ConvertTo7Bit</h3>
<div class="paragraph">
<p>Make sure the message stream is 7bit. Every 8bit part is encoded to
quoted-printable or base64 and the message is saved.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deconnectionright"><a class="anchor" href="#_deconnectionright"></a>DeconnectionRight</h3>
<div class="paragraph">
<p>Mailet to avoid people to receive emails outside working hour.</p>
</div>
<div class="paragraph">
<p>Working hours are defined by a starting time and an end time, on weekdays from monday to friday.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Emails received outside working hours are to be delayed to next working hours.</pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>&#8230;&#8203;.xml
&lt;mailet match="all" class="DeconnectionRight"&gt;
    &lt;zoneId&gt;Europe/Paris&lt;/zoneId&gt;
    &lt;workDayStart&gt;07:00:00&lt;/workDayStart&gt;
    &lt;workDayEnd&gt;20:00:00&lt;/metricName&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== DKIMSign

This mailet sign a message using the DKIM protocol
If the privateKey is encoded using a password then you can pass
the password as privateKeyPassword parameter.

Sample configuration with inlined private key:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match=&quot;All&quot; class=&quot;DKIMSign&quot;&gt;
  &lt;signatureTemplate&gt;v=1; s=selector; d=example.com; h=from:to:received:received; a=rsa-sha256; bh=; b=;&lt;/signatureTemplate&gt;
  &lt;privateKey&gt;
  -----BEGIN RSA PRIVATE KEY-----
  MIICXAIBAAKBgQDYDaYKXzwVYwqWbLhmuJ66aTAN8wmDR+rfHE8HfnkSOax0oIoT
  M5zquZrTLo30870YMfYzxwfB6j/Nz3QdwrUD/t0YMYJiUKyWJnCKfZXHJBJ+yfRH
  r7oW+UW3cVo9CG2bBfIxsInwYe175g9UjyntJpWueqdEIo1c2bhv9Mp66QIDAQAB
  AoGBAI8XcwnZi0Sq5N89wF+gFNhnREFo3rsJDaCY8iqHdA5DDlnr3abb/yhipw0I
  /1HlgC6fIG2oexXOXFWl+USgqRt1kTt9jXhVFExg8mNko2UelAwFtsl8CRjVcYQO
  cedeH/WM/mXjg2wUqqZenBmlKlD6vNb70jFJeVaDJ/7n7j8BAkEA9NkH2D4Zgj/I
  OAVYccZYH74+VgO0e7VkUjQk9wtJ2j6cGqJ6Pfj0roVIMUWzoBb8YfErR8l6JnVQ
  bfy83gJeiQJBAOHk3ow7JjAn8XuOyZx24KcTaYWKUkAQfRWYDFFOYQF4KV9xLSEt
  ycY0kjsdxGKDudWcsATllFzXDCQF6DTNIWECQEA52ePwTjKrVnLTfCLEG4OgHKvl
  Zud4amthwDyJWoMEH2ChNB2je1N4JLrABOE+hk+OuoKnKAKEjWd8f3Jg/rkCQHj8
  mQmogHqYWikgP/FSZl518jV48Tao3iXbqvU9Mo2T6yzYNCCqIoDLFWseNVnCTZ0Q
  b+IfiEf1UeZVV5o4J+ECQDatNnS3V9qYUKjj/krNRD/U0+7eh8S2ylLqD3RlSn9K
  tYGRMgAtUXtiOEizBH6bd/orzI9V9sw8yBz+ZqIH25Q=
  -----END RSA PRIVATE KEY-----
  &lt;/privateKey&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Sample configuration with file-provided private key:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match=&quot;All&quot; class=&quot;DKIMSign&quot;&gt;
  &lt;signatureTemplate&gt;v=1; s=selector; d=example.com; h=from:to:received:received; a=rsa-sha256; bh=; b=;&lt;/signatureTemplate&gt;
  &lt;privateKeyFilepath&gt;dkim-signing.pem&lt;/privateKeyFilepath&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>By default the mailet assume that Javamail will convert LF to CRLF when sending
so will compute the hash using converted newlines. If you don't want this
behaviour then set forceCRLF attribute to false.

=== DKIMVerify

This mailet verify a message using the DKIM protocol

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="DKIMVerify"&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>By default the mailet assume that Javamail will use LF instead of CRLF
so it will verify the hash using converted newlines. If you don't want this
behaviour then set forceCRLF attribute to false.

=== DSNBounce

Generates a Delivery Status Notification (DSN) Note that this is different
than a mail-client's reply, which would use the Reply-To or From header.

Bounced messages are attached in their entirety (headers and content) and the
resulting MIME part type is "message/rfc822".

The reverse-path and the Return-Path header of the response is set to "null"
("&lt;&gt;"), meaning that no reply should be sent.

A sender of the notification message can optionally be specified. If one is
not specified, the postmaster's address will be used.

Supports the &lt;code&gt;passThrough&lt;/code&gt; init parameter (true if missing).

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="DSNBounce"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered, default=postmaster*&lt;/sender&gt;
  &lt;prefix&gt;*optional subject prefix prepended to the original message*&lt;/prefix&gt;
  &lt;attachment&gt;*message, heads or none, default=message*&lt;/attachment&gt;
  &lt;messageString&gt;*the message sent in the bounce, the first occurrence of the pattern [machine] is replaced with the name of the executing machine, default=Hi. This is the James mail server at [machine] &#8230;&#8203; <strong>&lt;/messageString&gt;
  &lt;passThrough&gt;*true or false, default=true</strong>&lt;/passThrough&gt;
  &lt;debug&gt;*true or false, default=false*&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== Expires

Sanitizes or adds an expiration date to a message, in the form of an `Expires`
header (RFC 4021).

The mailet can force an existing expiration date to be within the bounds
given by `minAge`, `maxAge`, or both. `minAge` specifies the minimum time
the date must lie in the future, while `maxAge` specifies a maximum.

If a message has no expiration date, the mailet can add one according to
the optional `defaultAge` parameter.

All parameter values should be expressed in the following format: `Nunit`.
`N` should be positive. `unit` could be either in the short form
(`h`, `d`, `w`, `y` etc.), or in the long form (`hours`, days`, `weeks`,
`months`, `years`). The default unit is `days`.

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="Expires"&gt;
    &lt;minAge&gt;12h&lt;/minAge&gt;
    &lt;defaultAge&gt;7d&lt;/defaultAge&gt;
    &lt;maxAge&gt;8w&lt;/maxAge&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>By itself the `Expires` header is informational only. But some variants of James
will let you delete expired messages through the
xref:distributed/operate/webadmin.adoc#_administrating_messages[WebAdmin] interface:</pre>
</div>
</div>
<div class="paragraph">
<p>curl -XDELETE <a href="http://ip:port/messages?byExpiresHeader" class="bare">http://ip:port/messages?byExpiresHeader</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ExtractMDNOriginalJMAPMessageId

This mailet handles MDN messages and define a header X-JAMES-MDN-JMAP-MESSAGE-ID referencing
the original message (by its Jmap Id) asking for the recipient to send an MDN.

=== Forward

Replaces incoming recipients with those specified, and resends the message
unaltered.

Can be totally replaced by an equivalent usage of {@link Resend} (see below),
simply replacing *&lt;forwardto&gt;* with *&lt;recipients&gt;*.

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="Forward"&gt;
  &lt;forwardTo&gt;*comma delimited list of email addresses*&lt;/forwardTo&gt;
  &lt;passThrough&gt;*true or false, default=false*&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false, default=true*&lt;/fakeDomainCheck&gt;
  &lt;debug&gt;*true or false, default=false*&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The behaviour of this mailet is equivalent to using Resend with the following
configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="Resend"&gt;
  &lt;forwardTo&gt;comma delimited list of email addresses&lt;/recipients&gt;
  &lt;passThrough&gt;true or false&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false*&lt;/fakeDomainCheck&gt;
  &lt;debug&gt;*true or false*&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>*forwardto* can be used instead of *forwardTo*; such name is kept
for backward compatibility.

=== ICalendarParser

This mailet can be combined with the Strip attachment mailet.

The ICS body part byte array is arranged as map then this mailet should look for ICS and parse it
with Ical4J then store it as a mail attribute

Configuration: The mailet contains 2 mandatory attributes</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="ICalendarParser" &gt;
  &lt;sourceAttribute&gt;source.attribute.name&lt;/sourceAttribute&gt;
  &lt;!-- The attribute which contains output value of StripAttachment mailet -- &gt;
  &lt;destAttribute&gt;dest.attribute.name&lt;/destAttribute&gt;
  &lt;!-- The attribute store the map of Calendar -- &gt;
&lt;/mailet &gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ICALToHeader

ICALToHeader takes a Map of filenames to ICAL4J calendars, will pick the first Calendar,
and add it to the headers of the e-mail.

The following headers will be added : X_MEETING_UID, X_MEETING_METHOD, X_MEETING_RECURRENCE_ID, X_MEETING_SEQUENCE,
X_MEETING_DTSTAMP

The only configuration parameter for this mailet is the attribute the ICAL4J Calendar map should be attached to,
named *attribute*.

Configuration example :</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match=??? class=ICALToHeader&gt;
    &lt;attribute&gt;icalendars&lt;/attribute&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ICALToJsonAttribute

ICALToJsonAttribute takes a map of ICAL4J objects attached as attribute, and
output the map of corresponding json bytes as an other attribute, with unique String keys.

The JSON contains the following fields :

* *ical* : the raw ical string, in UTF-8
* *sender* : the sender of the mail (compulsory, mail without sender will be discarded)
* *recipient* : the recipient of the mail. If the mail have several recipients, each recipient will have its own JSON.
* *uid* : the UID of the ical (optional)
* *sequence* : the sequence of the ical (optional)
* *dtstamp* : the date stamp of the ical (optional)
* *method* : the method of the ical (optional)
* *recurrence-id* : the recurrence-id of the ical (optional)

Example are included in test call ICalToJsonAttributeTest.

Configuration example :</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match=??? class=ICALToJsonAttribute&gt;
    &lt;sourceAttribute&gt;icalendars&lt;/sourceAttribute&gt;
    &lt;destinationAttribute&gt;icalendarJson&lt;/destinationAttribute&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ICSSanitizer

Some senders embed 'text/calendar' content as part of Mime bodypart headers with an empty body.

This mailet duplicate the 'text/calendar' content to the Mime body part.

Example configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="ICSSanitizer"/&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== LocalDelivery

Receives a Mail from the Queue and takes care of delivery of the
message to local inboxes.

= LDAP matchers for Apache James

This project is an extension for Apache James that allows configuring conditions based on LDAP content within Apache
James mailetcontainer.

Those include:

 - LDAP conditions based on attributes of the recipients
 - LDAP conditions based on attributes of the sender
 - LDAP groups of the recipients
 - LDAP groups of the sender

Support is planned for LDAP groups both for sender and recipients.

== Set up

Build this project. For the root of the repository:

....bash
mvn clean install -DskipTests --am --pl :james-server-mailet-ldap</pre>
</div>
</div>
<div class="paragraph">
<p>Then copy the JAR located in <code>/target</code> into the <code>extensions-jars</code> folder of your Apache James installation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The LDAP settings are reused from the <code>usersrepository.xml</code> configuration file.</p>
</div>
<div class="paragraph">
<p>Then LDAP matchers can be configured within <code>mailetcontainer.xml</code>.</p>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="paragraph">
<p>&#8230;&#8203;.xml
&lt;!-- Matches recipients that have the following attribute with the specified value-&#8594;
&lt;mailet matcher="HasLDAPAttribute=description:blocked" class="Null"&gt;</p>
</div>
<div class="paragraph">
<p>&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>or

....xml
&lt;!-- Matches sender that have the following attribute with the specified value--&gt;
&lt;mailet matcher="SenderHasLDAPAttribute=description:blocked" class="Null"&gt;

&lt;/mailet&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="paragraph">
<p>&#8230;&#8203;.xml
&lt;!-- Matches recipients that have the following attribute regardless of the actual value-&#8594;
&lt;mailet matcher="HasLDAPAttribute=description" class="Null"&gt;</p>
</div>
<div class="paragraph">
<p>&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>or

....xml
&lt;!-- Matches sender that have the following attribute regardless of the actual value--&gt;
&lt;mailet matcher="SenderHasLDAPAttribute=description" class="Null"&gt;

&lt;/mailet&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For matching recipients against a specific LDAP group:</p>
</div>
<div class="paragraph">
<p>&#8230;&#8203;.xml
&lt;mailet matcher="IsInLDAPGroup=cn=mygroup,ou=groups, dc=james,dc=org" class="Null"&gt;</p>
</div>
<div class="paragraph">
<p>&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>For matching a sender against a specific LDAP group:

....xml
&lt;mailet matcher="SenderIsInLDAPGroup=cn=mygroup,ou=groups, dc=james,dc=org" class="Null"&gt;

&lt;/mailet&gt;</pre>
</div>
</div>
<div class="sect2">
<h3 id="_cache_settings"><a class="anchor" href="#_cache_settings"></a>Cache settings</h3>
<div class="paragraph">
<p>A cache can optionally be turned on in order to reduce LDAP calls for <code>SenderHasLDAPAttribute</code> and <code>HasLDAPAttribute</code>:</p>
</div>
<div class="paragraph">
<p>&#8230;&#8203;.xml
&lt;!-- Matches sender that have the following attribute regardless of the actual value-&#8594;
&lt;mailet matcher="SenderHasLDAPAttribute=description?cacheEnabled=true&amp;cacheSize=1000&amp;cacheDuration=1hour" class="Null"&gt;</p>
</div>
<div class="paragraph">
<p>&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The defaults are cache up to 10_000 entries for 1 day.

=== LogMessage

Logs Message Headers and/or Body.
If the "passThrough" in confs is true the mail will be left untouched in
the pipe. If false will be destroyed.  Default is true.

=== MailAttributesListToMimeHeaders

Convert attributes of type Collection&lt;String&gt; to headers

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="MailAttributesToMimeHeaders"&gt;
  &lt;simplemapping&gt;org.apache.james.attribute1;headerName1&lt;/simplemapping&gt;
  &lt;simplemapping&gt;org.apache.james.attribute2;headerName2&lt;/simplemapping&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== MailAttributesToMimeHeaders

Convert attributes of type Collection&lt;String&gt; to headers

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="MailAttributesToMimeHeaders"&gt;
  &lt;simplemapping&gt;org.apache.james.attribute1;headerName1&lt;/simplemapping&gt;
  &lt;simplemapping&gt;org.apache.james.attribute2;headerName2&lt;/simplemapping&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== MetricsMailet

This Metrics mailet increments a counter on every incoming emails.

This counter is accessible via JMX, or grafana. Read xref:distributed/operate/metrics.adoc[more about metrics].

Example :</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="all" class="MetricsMailet"&gt;
    &lt;metricName&gt;relayDenied&lt;/metricName&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Will increment a counter relayDenied

=== MailAttributesToMimeHeaders

This mailet replace the mail attribute map of key to MimePart
by a map of key to the MimePart content (as bytes).

It takes only one parameter:

* attribute (mandatory): mime content to be decoded, expected to be a Map&lt;String, byte[]&gt;

Then all this map attribute values will be replaced by their content.

=== NotifyPostmaster

Sends a notification message to the Postmaster.

A sender of the notification message can optionally be specified. If one is
not specified, the postmaster's address will be used.

The "To:" header of the notification message can be set to "unaltered"; if
missing will be set to the postmaster.

A notice text can be specified, and in such case will be inserted into the
notification inline text.

If the notified message has an "error message" set, it will be inserted into
the notification inline text. If the *attachError* init
parameter is set to true, such error message will be attached to the
notification message.

The notified messages are attached in their entirety (headers and content)
and the resulting MIME part type is "message/rfc822".

Supports the *passThrough* init parameter (true if missing).


Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="NotifyPostmaster"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered, default=postmaster*&lt;/sender&gt;
  &lt;attachError&gt;*true or false, default=false*&lt;/attachError&gt;
  &lt;message&gt;*notice attached to the original message text (optional)<strong>&lt;/message&gt;
  &lt;prefix&gt;*optional subject prefix prepended to the original message, default="Re:"</strong>&lt;/prefix&gt;
  &lt;inline&gt;*default=none*&lt;/inline&gt;
  &lt;attachment&gt;*default=message*&lt;/attachment&gt;
  &lt;passThrough&gt;*true or false, default=true*&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false, default=true*&lt;/fakeDomainCheck&gt;
  &lt;to&gt;*unaltered (optional, defaults to postmaster)<strong>&lt;/to&gt;
  &lt;debug&gt;*true or false, default=false</strong>&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The behaviour of this mailet is equivalent to using Resend with the following
configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="Resend"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered*&lt;/sender&gt;
  &lt;attachError&gt;*true or false*&lt;/attachError&gt;
  &lt;message&gt;*&lt;b&gt;dynamically built&lt;/b&gt;*&lt;/message&gt;
  &lt;prefix&gt;*a string*&lt;/prefix&gt;
  &lt;passThrough&gt;*true or false*&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false*&lt;/fakeDomainCheck&gt;
  &lt;to&gt;*&lt;b&gt;unaltered or postmaster&lt;/b&gt;*&lt;/to&gt;
  &lt;recipients&gt;&lt;b&gt;postmaster&lt;/b&gt;&lt;/recipients&gt;
  &lt;inline&gt;see {@link Resend}&lt;/inline&gt;
  &lt;attachment&gt;see {@link Resend}&lt;/attachment&gt;
  &lt;isReply&gt;true&lt;/isReply&gt;
  &lt;debug&gt;*true or false*&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>*notice*, *sendingAddress* and *attachError* can be used
instead of *message*, *sender* and *attachError*; such names
are kept for backward compatibility.

=== NotifySender

Sends a notification message to the sender of a message.

A sender of the notification message can optionally be specified. If one is
not specified, the postmaster's address will be used.

The "To:" header of the notification message can be set to "unaltered"; if
missing will be set to the sender of the notified message.

A notice text can be specified, and in such case will be inserted into the
notification inline text.

If the notified message has an "error message" set, it will be inserted into
the notification inline text. If the *attachError* init
parameter is set to true, such error message will be attached to the
notification message.

The notified messages are attached in their entirety (headers and content)
and the resulting MIME part type is "message/rfc822".

Supports the *passThrough* init parameter (true if missing).

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="NotifySender"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered, default=postmaster*&lt;/sender&gt;
  &lt;attachError&gt;*true or false, default=false*&lt;/attachError&gt;
  &lt;prefix&gt;*optional subject prefix prepended to the original message*&lt;/prefix&gt;
  &lt;inline&gt;default=none*&lt;/inline&gt;
  &lt;attachment&gt;default=message*&lt;/attachment&gt;
  &lt;passThrough&gt;*true or false, default=true*&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false, default=true*&lt;/fakeDomainCheck&gt;
  &lt;to&gt;*unaltered or sender or from(optional, defaults to sender)<strong>&lt;/to&gt;
  &lt;debug&gt;*true or false, default=false</strong>&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The behaviour of this mailet is equivalent to using Resend with the following
configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="Resend"&gt;
  &lt;sender&gt;*an address or postmaster or sender or unaltered*&lt;/sender&gt;
  &lt;attachError&gt;*true or false*&lt;/attachError&gt;
  &lt;message&gt;*&lt;b&gt;dynamically built&lt;/b&gt;*&lt;/message&gt;
  &lt;prefix&gt;*a string*&lt;/prefix&gt;
  &lt;passThrough&gt;true&lt;/passThrough&gt;
  &lt;fakeDomainCheck&gt;*true or false*&lt;/fakeDomainCheck&gt;
  &lt;to&gt;*unaltered or sender or from&amp;lt*;/to&gt;
  &lt;recipients&gt;&lt;b&gt;sender&lt;/b&gt;&lt;/recipients&gt;
  &lt;inline&gt;none&lt;/inline&gt;
  &lt;attachment&gt;message&lt;/attachment&gt;
  &lt;isReply&gt;true&lt;/isReply&gt;
  &lt;debug&gt;*true or false*&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>*notice*, *sendingAddress* and *attachError* can be used
instead of *message*, *sender* and *attachError*; such names
are kept for backward compatibility.


=== Null

Simplest Mailet which destroys any incoming messages by setting their state to GHOST.

This effectively stops all processing of this mail.

=== PostmasterAlias

Rewrites recipient addresses to make sure email for the postmaster is
always handled.  This mailet is silently inserted at the top of the root
spool processor.  All recipients mapped to postmaster@&lt;servernames&gt; are
changed to the postmaster account as specified in the server conf.

=== RandomStoring

Process messages and randomly assign them to 4 to 8 mailboxes.

=== RecipientRewriteTable

Mailet which should get used when using RecipientRewriteTable-Store to
implementations for mappings of forwards and aliases.

By specifying an 'errorProcessor' you can specify your logic upon RecipientRewriteTable failures.

Example:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="RecipientRewriteTable"&gt;
  &lt;errorProcessor&gt;rrt-errors&lt;/errorProcessor&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>The *rewriteSenderUponForward* option (default to true) can be used to prevent senders to be rewritten upon forwards in the transport envelope
(JAMES 3.8.0 default behaviour). *WARNING*: Please note that not rewriting the sender will cause issues forwarding emails
from external senders to external addresses as the DKIM and SPF records will not be matching the ones of the sending
domain.

The *forwardAutoSubmittedEmails* option (default to false) can be used to prevent forwarding bounces as such a scenario
can lead to an infinite loop if the forward recipient bounces the email.

=== RecipientToLowerCase

GenericMailet which convert all Recipients to lowercase.

=== Redirect

A mailet providing configurable redirection services.

Can produce listserver, forward and notify behaviour, with the original
message intact, attached, appended or left out altogether.

It differs from Resend because (i) some defaults are different,
notably for the following parameters: *&lt;recipients&gt;*,
*&lt;to&gt;*, *&lt;reversePath&gt;* and *&lt;inline&gt;*; (ii)
because it allows the use of the *&lt;static&gt;* parameter;.

Use &lt;code&gt;Resend&lt;/code&gt; if you need full control, &lt;code&gt;Redirect&lt;/code&gt; if
the more automatic behaviour of some parameters is appropriate.

This built in functionality is controlled by the configuration as laid out
below. In the table please note that the parameters controlling message
headers accept the &lt;b&gt;"unaltered"&lt;/b&gt; value, whose meaning is to
keep the associated header unchanged and, unless stated differently,
corresponds to the assumed default if the parameter is missing.

The configuration parameters are:


.Redirect parameters
|===
| Property name | explanation

| recipients
| A comma delimited list of addresses for recipients of this message; it will
use the "to" list if not specified, and "unaltered" if
none of the lists is specified.

These addresses will only appear in the To: header if no "to" list
is supplied.

Such addresses can contain "full names", like *Mr. John D. Smith
&lt;john.smith@xyz.com&gt;*.

The list can include constants "sender", "from",
"replyTo", "postmaster", "reversePath",
"recipients", "to", "null" and
"unaltered"; "replyTo" uses the ReplyTo header if
available, otherwise the From header if available, otherwise the Sender
header if available, otherwise the return-path; "from" is made
equivalent to "sender", and "to" is made equivalent to
"recipients"; "null" is ignored.

| to
| A comma delimited list of addresses to appear in the To: header; the email
will be delivered to any of these addresses if it is also in the recipients
list.

The recipients list will be used if this list is not supplied; if none of the
lists is specified it will be "unaltered".

Such addresses can contain "full names", like *Mr. John D. Smith
&lt;john.smith@xyz.com&gt;*.

The list can include constants "sender", "from",
"replyTo", "postmaster", "reversePath",
"recipients", "to", "null" and
"unaltered"; "from" uses the From header if available,
otherwise the Sender header if available, otherwise the return-path;
"replyTo" uses the ReplyTo header if available, otherwise the From
header if available, otherwise the Sender header if available, otherwise the
return-path; "recipients" is made equivalent to "to"; if
"null" is specified alone it will remove this header.

| sender
|  single email address to appear in the From: and Return-Path: headers and
become the sender.

It can include constants "sender", "postmaster" and
"unaltered"; "sender" is equivalent to
"unaltered".

Default: "unaltered".

| message
|A text message to insert into the body of the email.

Default: no message is inserted.

|inline
|
One of the following items:

* unaltered &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The original message is the new
message, for forwarding/aliasing
* heads&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The
headers of the original message are appended to the message
* body&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The
body of the original is appended to the new message
*
all&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp
;&amp;nbsp;&amp;nbsp;&amp;nbsp;Both headers and body are appended
* none&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
Neither body nor headers are appended
&lt;/ul&gt;
Default: "body".

|attachment
|One of the following items:

* heads&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The headers of the original are
attached as text
* body&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;The body of the original is
attached as text
* all&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Both
headers and body are attached as a single text file
* none&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Nothing is attached
* message &amp;nbsp;The original message is attached as type message/rfc822,
this means that it can, in many cases, be opened, resent, fw'd, replied to
etc by email client software.

Default: "none".

|passThrough
|true or false, if true the original message continues in the mailet processor
after this mailet is finished. False causes the original to be stopped.

Default: false.

|fakeDomainCheck
|true or false, if true will check if the sender domain is valid.

Default: true.

|attachError
|true or false, if true any error message available to the mailet is appended
to the message body (except in the case of inline == unaltered).

Default: false.

|replyTo
|A single email address to appear in the Reply-To: header.

It can include constants "sender", "postmaster"
"null" and "unaltered"; if "null" is specified
it will remove this header.

Default: "unaltered".

|reversePath
|A single email address to appear in the Return-Path: header.

It can include constants "sender", "postmaster" and
"null"; if "null" is specified then it will set it to &lt;&gt;,
meaning "null return path".

Notice: the "unaltered" value is *not allowed*.

Default: the value of the *&lt;sender&gt;* parameter, if set, otherwise
remains unaltered.

|subject
|An optional string to use as the subject.

Default: keep the original message subject.

|prefix
|An optional subject prefix prepended to the original message subject, or to a
new subject specified with the *&lt;subject&gt;* parameter.

For example: *[Undeliverable mail]*.

Default: ".

|isReply
|true or false, if true the IN_REPLY_TO header will be set to the id of the
current message.

Default: false.

|debug
|true or false. If this is true it tells the mailet to write some debugging
information to the mailet log.

Default: false.

|static
|true or false. If this is true it tells the mailet that it can reuse all the
initial parameters (to, from, etc) without re-calculating their values. This
will boost performance where a redirect task doesn't contain any dynamic
values. If this is false, it tells the mailet to recalculate the values for
each e-mail processed.

Default: false.
|===

Example:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre> &lt;mailet match="RecipientIs=test@localhost" class="Redirect"&gt;
   &lt;recipients&gt;x@localhost, y@localhost, z@localhost&lt;/recipients&gt;
   &lt;to&gt;list@localhost&lt;/to&gt;
   &lt;sender&gt;owner@localhost&lt;/sender&gt;
   &lt;message&gt;sent on from James&lt;/message&gt;
   &lt;inline&gt;unaltered&lt;/inline&gt;
   &lt;passThrough&gt;FALSE&lt;/passThrough&gt;
   &lt;replyTo&gt;postmaster&lt;/replyTo&gt;
   &lt;prefix xml:space="preserve"&gt;[test mailing] &lt;/prefix&gt;
   &lt;!-- note the xml:space="preserve" to preserve whitespace --&gt;
   &lt;static&gt;TRUE&lt;/static&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>and:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="Redirect"&gt;
  &lt;recipients&gt;x@localhost&lt;/recipients&gt;
  &lt;sender&gt;postmaster&lt;/sender&gt;
  &lt;message xml:space="preserve"&gt;Message marked as spam:&lt;/message&gt;
  &lt;inline&gt;heads&lt;/inline&gt;
  &lt;attachment&gt;message&lt;/attachment&gt;
  &lt;passThrough&gt;FALSE&lt;/passThrough&gt;
  &lt;attachError&gt;TRUE&lt;/attachError&gt;
  &lt;replyTo&gt;postmaster&lt;/replyTo&gt;
  &lt;prefix&gt;[spam notification]&lt;/prefix&gt;
  &lt;static&gt;TRUE&lt;/static&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>*replyto* can be used instead of *replyTo*; such name is kept for
backward compatibility.

=== RemoteDelivery

The RemoteDelivery mailet delivers messages to a remote SMTP server able to deliver or forward messages to their final
destination.

The remote SMTP server through which each mail is delivered is resolved using MX lookup for each message destination
unless the *&lt;gateway/&gt;* parameter is set. The *&lt;gateway/&gt;* parameter enables the
definition of one or more gateway servers through which all messages are sent.

If an attempt to deliver a message fails, a redelivery attempt is scheduled according to the scheme defined
by the *&lt;delayTime/&gt;* parameter, retrying up to the limit defined
by the *&lt;maxRetries/&gt;* parameter. When the retry limit is exceeded, delivery failure is processed
according to the setting of the *&lt;bounceProcessor/&gt;* parameter.

These are the parameters that control the operation of the RemoteDelivery mailet:

* *outgoing* (required) - a String containing the name of the queue that will hold messages being processed by this mailet.
* *bind* (optional) - a String describing the local IP address to which the mailet should be bound while delivering
emails. This tag is useful for multihomed machines. Default is to bind to the default local address of the machine.&lt;br&gt;
Note: The same IP address must be used for all of those RemoteDelivery instances where you explicitly supply a bind address.
* *delayTime* (optional) a String containing a comma separated list of patterns defining the number of and delays between delivery
attempts. The pattern is *[attempts\*]delay [unit]* where:

** *attempts* (optional) - an Integer for the number of delivery attempts. Default is 1.
** *delay* (required) - a Long for the delay between attempts.
** *unit* (optional) - a String with the value of one of 'msec', 'sec', 'minute', 'hour', or 'day'. Default is msec.

Default is one attempt after 6 hours, which if explicitly declared would be written as *&lt;delayTime&gt;1 6 hour&lt;/delayTime&gt;*

* *maxRetries* (optional) an Integer for the number of times an attempt is made to deliver a particular mail.
Default is the greater of five and the sum of the attempts for each *&lt;delayTime/&gt;* specified.
* *maxDnsProblemRetries* (optional) - an Integer for the number of times to retry if DNS problems for a domain occur.
Default is 0.
* *timeout* (optional) - an Integer for the Socket I/O timeout in milliseconds. Default is 180000
* *connectionTimeout* (optional) - an Integer for the Socket connection timeout in milliseconds. Default is 60000
* *bounceProcessor* (optional) - a String containing the name of the mailet processor to pass messages that cannot
be delivered to for DSN bounce processing. Default is to send a traditional message containing the bounce details.
* *onSuccess* (optional) - if specified, this processor is called for each email successfully sent to remote third parties.

When using bounceProcessor or onSuccess processors, take special care of error handling (see onMailetException and onMatcherException)
 to avoid confusing situations. Also remember that on partial delivery, both processors will be used: *onSuccess* with successfull recipients,
 and *bounceProcessor* with failed recipients.

* *startTLS* (optional) - a Boolean (true/false) indicating whether the STARTTLS command (if supported by the server)
to switch the connection to a TLS-protected connection before issuing any login commands. Default is false.
* *sslEnable* (optional) - a Boolean (true/false) indicating whether to use SSL to connect and use the SSL port unless
explicitly overridden. Default is false. Setting up to true will result in delivery attempts in SMTPS on port 465 with a fallback
to SMTP on port 25. The trust-store if needed can be customized by *-Djavax.net.ssl.trustStore=/root/conf/keystore*.
* *verifyServerIdentity* (optional) - a Boolean (true/false) indicating whether to match the remote server name against its certificate on TLS connections. Default is true. Disabling this runs the risk of someone spoofing a legitimate server and intercepting mails, but may be necessary to contact servers that have strange certificates, no DNS entries, are reachable by IP address only, and similar edge cases.
* *gateway* (optional) - a String containing a comma separated list of patterns defining the gateway servers to be used to
deliver mail regardless of the recipient address. If multiple gateway servers are defined, each will be tried in definition order
until delivery is successful. If none are successful, the mail is bounced. The pattern is *host[:port]* where:

* *host* (required) - the FQN of the gateway server.
* *port* (optional) - the port of the gateway server. Default is the value defined in the *&lt;gatewayPort/&gt;*
parameter if set, else the default port for the specified connection type.
Default is to resolve the destination SMTP server for each mail using MX lookup.

* *gatewayPort* (optional) - an Integer for the gateway port to be used for each defined gateway server for which a
port is not explicitly defined in the *&lt;gateway/&gt;* parameter. Default is the default port for the specified connection type.
* *gatewayUsername* (optional) - a String containing the user name to be used to authenticate the user using the
AUTH command. Default is not to issue the AUTH command.
* *gatewayPassword* (required if *gatewayUsername*) is set - a String representing the password to be used
to authenticate the user using the AUTH command.
* *loadBalancing* (optional) - a Boolean (true/false) indicating whether load should be balanced randomly over all defined gateway server. Default is true, false leads to failover only.
* *heloName* (optional) - a String containing the name used in the SMTP HELO and EHLO commands. Default is the default domain,
which is typically *localhost*.
* *mail.** (optional) - Any property beginning with *mail.* described in the Javadoc for package
&lt;a href="https://eclipse-ee4j.github.io/angus-mail/docs/api/org.eclipse.angus.mail/org/eclipse/angus/mail/smtp/package-summary.html"&gt;*org.eclipse.angus.mail.smtp*&lt;/a&gt;
can be set with a parameter of the corresponding name. For example the parameter
*&lt;mail.smtp.ssl.enable&gt;true&lt;/mail.smtp.ssl.enable&gt;* is equivalent to the Java code
*props.put("mail.smtp.ssl.enable", "true");*. Properties set by this facility override settings made
within the mailet code.&lt;br&gt;
Note: This facility should be used with extreme care by expert users with a thorough knowledge of the relevant RFCs and
the ability to perform their own problem resolutions.
* *debug* (optional) - a Boolean (true/false) indicating whether debugging is on. Default is false.
* *usePriority* (optional) - a Boolean value (true/false) that indicates whether email priority support is enabled.
When the property is set to false, it allows for the disabling of priorities when interacting with unknown third-party
systems during remote delivery MX resolution. When this option is enabled, any email will be assigned the lowest priority
during retry attempts. Default is false.

==== Security

You can use the *sslEnable* parameter described above to force SMTP outgoing delivery to default to SSL encrypted traffic (SMTPS).
This is a shortcut for the *mail.smtps.ssl.enable* javax property.

When enabling SSL, you might need to specify the *mail.smtps.ssl.trust* property as well.
You can also control ciphersuites and protocols via *mail.smtps.ssl.ciphersuites* and
*mail.smtps.ssl.protocols* properties.

StartTLS can alternatively be enabled upon sending a mail. For this, use the *startTls* parameter, serving as a shortcut for the
javax *mail.smtp.starttls.enable* property. Depending on how strict your security policy is, you might consider
*mail.smtp.starttls.required* as well. Be aware that configuring trust will then be required.
You can also use other javax properties for StartTLS, but their property prefix must be *mail.smtp.ssl.* in this case.

James enables server identity verification by default. In certain rare edge cases you might disable it via the *verifyServerIdentity* parameter,
or use the *mail.smtps.ssl.checkserveridentity* and *mail.smtp.ssl.checkserveridentity* javax properties for fine control.

Read https://eclipse-ee4j.github.io/angus-mail/docs/api/org.eclipse.angus.mail/org/eclipse/angus/mail/smtp/package-summary.html[*org.eclipse.angus.mail.smtp*]
for full information.

=== RemoveAllMailAttributes

This mailet sets removes all attributes set on the Mail instance

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="RemoveAllMailAttributes"/&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== RemoveMailAttribute

This mailet sets attributes on the Mail.

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="RemoveMailAttribute"&gt;
  &lt;name&gt;attribute_name1&lt;/name&gt;
  &lt;name&gt;attribute_name2&lt;/name&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== RemoveMimeHeader

Remove mime headers from the message (global) and per recipient (specific).

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="RemoveMimeHeader"&gt;
  &lt;name&gt;header1,header2&lt;/name&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== RemoveMimeHeader

This mailet removes all of the headers starting with a given prefix in the message (global) and per recipient (specific).

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="RemoveMimeHeaderByPrefix"&gt;
  &lt;name&gt;X-APPLICATIVE-HEADER-&lt;/name&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ReplaceContent

Replace text contents

This mailet allow to specific regular expression to replace text in subject and content.


Each expression is defined as: */REGEX_PATTERN/SUBSTITUTION_PATTERN/FLAGS/*

* *REGEX_PATTERN* is a regex used for the match
* *SUBSTITUTION_PATTERN* is a substitution pattern
* *FLAGS* flags supported for the pattern:
** i: case insensitive
** m: multi line
** x: extended (N/A)
** r: repeat - keep matching until a substitution is possible

To identify subject and body pattern we use the tags &lt;subjectPattern&gt; and &lt;bodyPattern&gt;

Rules can be specified in external files.
Lines must be CRLF terminated and lines starting with # are considered comments.
Tags used to include external files are &lt;subjectPatternFile&gt; and
&lt;bodyPatternFile&gt;
If file path starts with # then the file is loaded as a resource.

Use of both files and direct patterns at the same time is allowed.

This mailet allow also to enforce the resulting charset for messages processed, when a replacement has been done.
To do that the tag &lt;charset&gt; must be specified.

NOTE:
Regexp rules must be escaped by regexp escaping rules and applying this 2 additional rules:

- "/" char inside an expression must be prefixed with "\":
  e.g: "/\//-//" replaces "/" with "-"
- when the rules are specified using &lt;subjectPattern&gt; or &lt;bodyPattern&gt; and
  "/,/" has to be used in a pattern string it must be prefixed with a "\".
  E.g: "/\/\/,//" replaces "/" with "," (the rule would be "/\//,//" but the "/,/" must
  be escaped.

=== Resend
A mailet providing configurable redirection services.

Can produce listserver, forward and notify behaviour, with the original
message intact, attached, appended or left out altogether. Can be used as a
replacement to {@link Redirect}, having more consistent defaults, and new
options available.

Use &lt;code&gt;Resend&lt;/code&gt; if you need full control, &lt;code&gt;Redirect&lt;/code&gt; if
the more automatic behaviour of some parameters is appropriate.

This built in functionality is controlled by the configuration as laid out
below. In the table please note that the parameters controlling message
headers accept the &lt;b&gt;"unaltered"&lt;/b&gt; value, whose meaning is to
keep the associated header unchanged and, unless stated differently,
corresponds to the assumed default if the parameter is missing.

The configuration parameters are:

.Resend properties
|===
| Property name | explanation

| recipients
| A comma delimited list of addresses for recipients of this message.

Such addresses can contain "full names", like *Mr. John D. Smith
&lt;john.smith@xyz.com&gt;*.

The list can include constants "sender", "from",
"replyTo", "postmaster", "reversePath",
"recipients", "to", "null" and
"unaltered"; "replyTo" uses the ReplyTo header if
available, otherwise the From header if available, otherwise the Sender
header if available, otherwise the return-path; "from" is made
equivalent to "sender", and "to" is made equivalent to
"recipients"; "null" is ignored. Default:
"unaltered".

| to
| A comma delimited list of addresses to appear in the To: header.

Such addresses can contain "full names", like *Mr. John D. Smith
&lt;john.smith@xyz.com&gt;*.

The list can include constants "sender", "from",
"replyTo", "postmaster", "reversePath",
"recipients", "to", "null" and
"unaltered"; "from" uses the From header if available,
otherwise the Sender header if available, otherwise the return-path;
"replyTo" uses the ReplyTo header if available, otherwise the From
header if available, otherwise the Sender header if available, otherwise the
return-path; "recipients" is made equivalent to "to"; if
"null" is specified alone it will remove this header. Default:
"unaltered".

| sender
| A single email address to appear in the From: header and become the sender.

It can include constants "sender", "postmaster" and
"unaltered"; "sender" is equivalent to
"unaltered".

Default: "unaltered".

|message
|A text message to insert into the body of the email.

Default: no message is inserted.

|inline
|One of the following items:
&lt;/p&gt;
&lt;ul&gt;
* unaltered     The original message is the new
message, for forwarding/aliasing
* heads          The
headers of the original message are appended to the message
* body           The
body of the original is appended to the new message
*
all           &amp;nbsp
;   Both headers and body are appended
* none
Neither body nor headers are appended

Default: "unaltered".

|attachment
|One of the following items:

* heads      The headers of the original are
attached as text
* body       The body of the original is
attached as text
* all           Both
headers and body are attached as a single text file
* none       Nothing is attached
* message  The original message is attached as type message/rfc822,
this means that it can, in many cases, be opened, resent, fw'd, replied to
etc by email client software.

Default: "none".

|passThrough
|true or false, if true the original message continues in the mailet processor
after this mailet is finished. False causes the original to be stopped.

Default: false.

|fakeDomainCheck
|true or false, if true will check if the sender domain is valid.

Default: true.

|attachError
|true or false, if true any error message available to the mailet is appended
to the message body (except in the case of inline == unaltered).

Default: false.

|replyTo
|A single email address to appear in the Reply-To: header.

It can include constants "sender", "postmaster"
"null" and "unaltered"; if "null" is specified
it will remove this header.

Default: "unaltered".

|reversePath
|A single email address to appear in the Return-Path: header.

It can include constants "sender", "postmaster"
"null" and "unaltered"; if "null" is specified
then it will set it to &lt;&gt;, meaning "null return path".

Default: "unaltered".

|subject
|An optional string to use as the subject.

Default: keep the original message subject.

|prefix
|
An optional subject prefix prepended to the original message subject, or to a
new subject specified with the *&lt;subject&gt;* parameter.

For example: *[Undeliverable mail]*.

|isReply
|true or false, if true the IN_REPLY_TO header will be set to the id of the
current message.

Default: false.

|debug
|true or false. If this is true it tells the mailet to write some debugging
information to the mailet log.

Default: false.
|===


Example:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre> &lt;mailet match="RecipientIs=test@localhost" class="Resend"&gt;
   &lt;recipients&gt;x@localhost, y@localhost, z@localhost&lt;/recipients&gt;
   &lt;to&gt;list@localhost&lt;/to&gt;
   &lt;sender&gt;owner@localhost&lt;/sender&gt;
   &lt;message&gt;sent on from James&lt;/message&gt;
   &lt;inline&gt;unaltered&lt;/inline&gt;
   &lt;passThrough&gt;FALSE&lt;/passThrough&gt;
   &lt;replyTo&gt;postmaster&lt;/replyTo&gt;
   &lt;prefix xml:space="preserve"&gt;[test mailing] &lt;/prefix&gt;
   &lt;!-- note the xml:space="preserve" to preserve whitespace --&gt;
   &lt;static&gt;TRUE&lt;/static&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>and:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="Resend"&gt;
  &lt;recipients&gt;x@localhost&lt;/recipients&gt;
  &lt;sender&gt;postmaster&lt;/sender&gt;
  &lt;message xml:space="preserve"&gt;Message marked as spam:&lt;/message&gt;
  &lt;inline&gt;heads&lt;/inline&gt;
  &lt;attachment&gt;message&lt;/attachment&gt;
  &lt;passThrough&gt;FALSE&lt;/passThrough&gt;
  &lt;attachError&gt;TRUE&lt;/attachError&gt;
  &lt;replyTo&gt;postmaster&lt;/replyTo&gt;
  &lt;prefix&gt;[spam notification]&lt;/prefix&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>The following example forwards the message without any modification, based on
the defaults:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="Resend&amp;quot/;&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>*replyto* can be used instead of *replyTo*; such name is kept for
backward compatibility.

WARNING: as the message (or a copy of it) is reinjected in the spool
without any modification, the preceding example is very likely to cause a
"configuration loop" in your system, unless some other mailet has previously
modified something (a header for instance) that could force the resent
message follow a different path so that it does not return here
unchanged.

=== SetMailAttribute

This mailet sets attributes on the Mail.

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="SetMailAttribute"&gt;
  &lt;name1&gt;value1&lt;/name1&gt;
  &lt;name2&gt;value2&lt;/name2&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== SetMailAttribute

Adds a specified header and value to the message.

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="AddHeader"&gt;
  &lt;name&gt;X-MailetHeader&lt;/name&gt;
  &lt;value&gt;TheHeaderValue&lt;/value&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== Sieve

Execute Sieve scripts for incoming emails, and set the result of the execution as attributes of the mail

=== Sign

Puts a *server-side* SMIME signature on a message.

It is a concrete subclass of Sign, with very few modifications to it,
to specialize for SMIME.

Handles the following init parameters:

* &lt;keyHolderClass&gt;: Sets the class of the KeyHolder object that will handle the cryptography functions,
 for example org.apache.james.security.SMIMEKeyHolder for SMIME.
* &lt;debug&gt;: if *true* some useful information is logged.
 The default is *false*.
* &lt;keyStoreFileName&gt;: the {@link java.security.KeyStore} full file name.
* &lt;keyStorePassword&gt;: the *KeyStore* password.
If given, it is used to check the integrity of the keystore data,
otherwise, if null, the integrity of the keystore is not checked.
* &lt;keyAlias&gt;: the alias name to use to search the Key using {@link java.security.KeyStore#getKey}.
 The default is to look for the first and only alias in the keystore;
 if zero or more than one is found a {@link java.security.KeyStoreException} is thrown.
* &lt;keyAliasPassword&gt;: the alias password. The default is to use the *KeyStore* password.
 At least one of the passwords must be provided.
* &lt;keyStoreType&gt;: the type of the keystore. The default will use {@link java.security.KeyStore#getDefaultType}.
* &lt;postmasterSigns&gt;: if *true* the message will be signed even if the sender is the Postmaster. The default is *true*.
* &lt;rebuildFrom&gt;: If *true* will modify the "From:" header. The default is *true*.
* &lt;signerName&gt;: the name of the signer to be shown in the explanation text. The default is to use the "CN="
property of the signing certificate.
* &lt;explanationText&gt;. There is a default explanation string template in English, displaying
also all the headers of the original message.

=== SMIMECheckSignature

Verifies the s/mime signature of a message. The s/mime signing ensure that
the private key owner is the real sender of the message. To be checked by
this mailet the s/mime signature must contain the actual signature, the
signer's certificate and optionally a set of certificate that can be used to
create a chain of trust that starts from the signer's certificate and leads
to a known trusted certificate.

This check is composed by two steps: firstly it's ensured that the signature
is valid, then it's checked if a chain of trust starting from the signer
certificate and that leads to a trusted certificate can be created. The first
check verifies that the message has not been modified after the signature
was put and that the signer's certificate was valid at the time of the
signing. The latter should ensure that the signer is who he declare to be.

The results of the checks perfomed by this mailet are wrote as a mail
attribute which default name is org.apache.james.SMIMECheckSignature (it can
be changed using the mailet parameter *mailAttribute*). After
the check this attribute will contain a list of SMIMESignerInfo object, one
for each message's signer. These objects contain the signer's certificate and
the trust path.

Optionally, specifying the parameter *strip*, the signature of
the message can be stripped after the check. The message will become a
standard message without an attached s/mime signature.

The configuration parameter of this mailet are summerized below. The firsts
defines the location, the format and the password of the keystore containing
the certificates that are considered trusted. Note: only the trusted certificate
entries are read, the key ones are not.

* fileType (default: keystore): type of file that is used to construct keystore object. Possible values: keystore, pem.

If fileType is "keystore". The following configuration parameters would be used:

* keyStoreType (default: jks): Certificate store format . "jks" is the
standard java certificate store format, but pkcs12 is also quite common and
compatible with standard email clients like Outlook Express and Thunderbird.
* keyStoreFileName (default: JAVA_HOME/jre/lib/security/cacert): Certificate
store path.
* keyStorePassword (default: ""): Certificate store password.

If fileType is "pem". The following configuration parameters would be used:

* pemFileName: pem file path.

Other parameters configure the behavior of the mailet:

* strip (default: false): Defines if the s/mime signature of the message
have to be stripped after the check or not. Possible values are true and
false.
* mailAttribute (default: org.apache.james.SMIMECheckSignature):
specifies in which attribute the check results will be written.
* onlyTrusted (default: true): Usually a message signature to be
considered by this mailet as authentic must be valid and trusted. Setting
this mailet parameter to "false" the last condition is relaxed and also
"untrusted" signature are considered will be considered as authentic.

=== SMIMEDecrypt

This mailet decrypts a s/mime encrypted message. It takes as input an
encrypted message and it tries to dechiper it using the key specified in its
configuration. If the decryption is successful the mail will be changed and
it will contain the decrypted message. The mail attribute
*org.apache.james.SMIMEDecrypt* will contain the public
certificate of the key used in the process.

The configuration parameters of this mailet are summarized below. The firsts
define the keystore where the key that will be used to decrypt messages is
saved.

* keyStoreType (default: system dependent): defines the type of the store.
Usually jks, pkcs12 or pkcs7
* keyStoreFileName (mandatory): private key store path.
* keyStorePassword (default: ""): private key store password

The other parameters define which private key have to be used. (if the store
contains more than one key).

* keyAlias: private key alias.
* keyPass: private key password


=== SMIMESign

Puts a *server-side* signature on a message.

It is a concrete subclass of AbstractSign, with very few modifications to it.

A text file with an explanation text is attached to the original message,
and the resulting message with all its attachments is signed.

* The resulting appearance of the message is almost unchanged: only an extra attachment
* and the signature are added.

The kind of signature depends on the value of the &lt;keyHolderClass&gt; init parameter.

Handles the following init parameters:

* &lt;keyHolderClass&gt;: Sets the class of the KeyHolder object that will handle the cryptography functions,
for example org.apache.james.security.SMIMEKeyHolder for SMIME.
* &lt;debug&gt;: if *true* some useful information is logged.
The default is *false*.
* &lt;keyStoreFileName&gt;: the {@link java.security.KeyStore} full file name.
* &lt;keyStorePassword&gt;: the *KeyStore* password.
If given, it is used to check the integrity of the keystore data,
otherwise, if null, the integrity of the keystore is not checked.
* &lt;keyAlias&gt;: the alias name to use to search the Key using {@link java.security.KeyStore#getKey}.
The default is to look for the first and only alias in the keystore;
if zero or more than one is found a {@link java.security.KeyStoreException} is thrown.
* &lt;keyAliasPassword&gt;: the alias password. The default is to use the *KeyStore* password.
At least one of the passwords must be provided.
* &lt;keyStoreType&gt;: the type of the keystore. The default will use {@link java.security.KeyStore#getDefaultType}.
* &lt;postmasterSigns&gt;: if *true* the message will be signed even if the sender is the Postmaster. The default is *true*.
* &lt;rebuildFrom&gt;: If *true* will modify the "From:" header. The default is *true*.
* &lt;signerName&gt;: the name of the signer to be shown in the explanation text. The default is to use the "CN="
property of the signing certificate.
* &lt;explanationText&gt;. There is a default explanation string template in English, displaying
also all the headers of the original message.

=== SpamAssassin

Sends the message through daemonized SpamAssassin (spamd), visit
http://spamassassin.apache.org[spamassassin.apache.org] for info
on configuration. The header X-Spam-Status is added to every message, this
contains the score and the threshold score for spam (usually 5.0). If the
message exceeds the threshold, the header X-Spam-Flag will be added with the
value of YES. The default host for spamd is localhost and the default port is
783.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>org.apache.james.spamassassin.status - Holds the status
org.apache.james.spamassassin.flag   - Holds the flag</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Sample Configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet notmatch="SenderHostIsLocal" class="SpamAssassin"&gt;
  &lt;spamdHost&gt;localhost&lt;/spamdHost&gt;
  &lt;spamdPort&gt;783&lt;/spamdPort&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== StripAttachment

Remove attachments from a Message. Supports simple removal, storing to file,
or storing to mail attributes.

Configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match=&quot;All&quot; class=&quot;StripAttachment&quot; &gt;
  &lt;pattern &gt;.<strong>\.xls &lt;/pattern&gt;  &lt;!-- The regular expression that must be matched&#8201;&#8212;&#8201;&gt;
  &lt;!-- notpattern &gt;.</strong>\.xls &lt;/notpattern-&#8594;  &lt;!-- The regular expression that must be matched&#8201;&#8212;&#8201;&gt;
  &lt;mimeType&gt;text/calendar&lt;/mimeType&gt;  &lt;!-- The matching mimeType&#8201;&#8212;&#8201;&gt;
  &lt;directory &gt;c:\temp\james_attach &lt;/directory&gt;   &lt;!-- The directory to save to&#8201;&#8212;&#8201;&gt;
  &lt;remove &gt;all &lt;/remove&gt;   &lt;!-- either &quot;no&quot;, &quot;matched&quot;, &quot;all&quot;&#8201;&#8212;&#8201;&gt;
  &lt;!-- attribute&gt;my.attribute.name&lt;/attribute -&#8594;
&lt;/mailet &gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>At least one of pattern, notpattern and mimeType is required.


=== TextCalendarBodyToAttachment

This mailet converts Content-Type of MimeMessage from text/calendar to mulitpart/mixed

The BodyPart should be retrieved from content of text/calendar with all the same "Content-*" headers from original message
and those "Content-" header are removed from original message

It does not takes any parameter

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="TextCalendarBodyToAttachment"/&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ToProcessor

This mailet redirects the mail to the named processor

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="ToProcessor"&gt;
  &lt;processor&gt;spam&lt;/processor&gt;
  &lt;notice&gt;Notice attached to the message (optional)&lt;/notice&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ToRepository

Stores incoming Mail in the specified Repository.

If the "passThrough" in conf is true the mail will be returned untouched in
the pipe and may be processed by additional mailets. If false will be destroyed.

=== ToSenderDomainRepository

Stores incoming Mail in a repository defined by the sender's domain.&lt;br&gt;

Supported configuration parameters:

* "urlPrefix" mandatory: defines the prefix for the per sender's domain repository. For example for the value
'cassandra://var/mail/sendersRepositories/', a mail sent by 'user@james.org' will be stored
in 'cassandra://var/mail/sendersRepositories/james.org'.
* "passThrough" optional, defaults to false. If true, the processing of the mail continues. If false it stops.
* "allowRepositoryCreation" optional, defaults to true. If true, non existing repository will be created. In case of
misconfiguration, this might lead to arbitrary repository creation. If false, the incoming mails will be stored only
 in already existing repository. If not existing, the email will be dropped with an appropriate log warning (leading
 to potential data loss). In case, you want to create a repository manually, make a http PUT request to
 /mailRepositories/encodedUrlOfTheRepository from web admin api.
  For example http://ip:port/mailRepositories/file%3A%2F%2FmailRepo

Example:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="ToSenderDomainRepository"&gt;
    &lt;urlPrefix&gt;cassandra://var/mail/sendersRepositories/&lt;/urlPrefix&gt;
    &lt;passThrough&gt;false&lt;/passThrough&gt;
    &lt;allowRepositoryCreation&gt;true&lt;/allowRepositoryCreation&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== VacationMailet

This mailet uses https://jmap.io/spec-mail.html#vacation-response[JMAP VacationResponse] and
sends back a vacation notice to the sender if needed.

=== WithPriority

This mailet sets the priority of the incoming mail.

Example configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="WithPriority"&gt;
 &lt;priority&gt;7&lt;/priority&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== WithStorageDirective

WithStorageDirective position storage directive for the recipients of this email.

These directives are used by &lt;strong&gt;LocalDelivery&lt;/strong&gt; mailet when adding the email to the recipients mailboxes.

The following storage directives can be set:

* targetFolderNames: the folders to append the email in. Defaults to none (INBOX). Coma separated list of folder names. Fallback to targetFolderName.
* targetFolderName: the folder to append the email in. Defaults to none (INBOX).
* seen: boolean, whether the message should be automatically marked as seen. Defaults to false.
* important: boolean, whether the message should be automatically marked as important. Defaults to false.
* keywords: set of string, encoded as a string (value are coma separated). IMAP user flags to set for the message. Defaults to none

Example:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="IsMarkedAsSpam" class="WithStorageDirective"&gt;
    &lt;targetFolderName&gt;Spam&lt;/targetFolderName&gt;
    &lt;seen&gt;true&lt;/seen&gt;
    &lt;important&gt;true&lt;/important&gt;
    &lt;keywords&gt;keyword1,keyword2&lt;/keywords&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Alternatively, several target folders can be specified:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="IsMarkedAsSpam" class="WithStorageDirective"&gt;
  &lt;targetFolderNames&gt;Important, INBOX&lt;/targetFolderNames&gt;
  &lt;seen&gt;true&lt;/seen&gt;
  &lt;important&gt;true&lt;/important&gt;
  &lt;keywords&gt;keyword1,keyword2&lt;/keywords&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>== Experimental mailets

=== AddHabeasWarrantMark

This matcher adds the Hebeas Warrant Mark to a message.

For details see: http://www.hebeas.com&lt;/p&gt;

Usage:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="AddHabeasWarrantMark" /&gt;;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>NOTE: Although this mailet is covered by the Apache Software License,
the Habeas Warrant Mark is copyright.  A separate license from Habeas
is required in order to legally attach the Habeas Warrant Mark to
e-mail messages.  Each James Administrator is responsible for
ensuring that James is configured to attach the Habeas Warrant Mark
only to e-mail covered by a suitable license received from Habeas.

Because the Habeas Warrant Mark is copyright material, I have asked
for and received the following explicit statement from Habeas:</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>From: Lindsey Pettit [mailto:support@habeas.com]
Sent: Sunday, September 29, 2002 5:51
To: Noel J. Bergman
Subject: RE: Habeas and Apache James
*
Dear Noel,
*
&gt; FURTHERMORE, if James is to be capable of sending Habeas SWE, I need
&gt; to write a Mailet that attaches the headers.  As with any MTA, it
&gt; would be up to the administrator to properly configure James and make
&gt; sure that licenses are acquired.  Since the Habeas Warrant Mark is
&gt; copyright, I believe that I require authorization from you for that
&gt; Mailet, especially since it attaches the Habeas Warrant Mark.  For my
&gt; own protection, please show me why such authorization is unnecessary,
&gt; send me a digitally signed e-mail, or FAX a signed authorization
*
You do not yourself need the authorization to build the functionality
into the [mailet];  what one needs authorization, in the form of a
license, for, is to use the mark *in headers*, in outgoing email.
However, please let me know if you would like something more
formal, and I can try to have something faxed to you.
*
&gt; The Mailet docs would reference the Habeas website, and inform
&gt; administrators that in order to USE the mailet, they need to ensure
&gt; that they have whatever licenses are required from you as appropriate
&gt; to your licensing terms.
*
That's absolutely perfect!</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ClamAVScan

Does an antivirus scan check using a ClamAV daemon (CLAMD)

Interacts directly with the daemon using the "stream" method,
which should have the lowest possible overhead.

The CLAMD daemon will typically reside on *localhost*, but could reside on a
different host.
It may also consist on a set of multiple daemons, each residing on a different
server and on different IP number.
In such case a DNS host name with multiple IP addresses (round-robin load sharing)
is supported by the mailet (but on the same port number).

Handles the following init parameters:

* *&lt;debug&gt;*
* *&lt;host&gt;*: the host name of the server where CLAMD runs. It can either be
a machine name, such as
"*java.sun.com*", or a textual representation of its
IP address. If a literal IP address is supplied, only the
validity of the address format is checked.
If the machine name resolves to multiple IP addresses, *round-robin load sharing* will
be used.
The default is *localhost*.
* *&lt;port&gt;*: the port on which CLAMD listens. The default is *3310*.
* *&lt;maxPings&gt;*: the maximum number of connection retries during startup.
If the value is *0* no startup test will be done.
The default is *6*.
* *&lt;pingIntervalMilli&gt;*: the interval (in milliseconds)
between each connection retry during startup.
The default is *30000* (30 seconds).
* *&lt;streamBufferSize&gt;*: the BufferedOutputStream buffer size to use
writing to the *stream connection*. The default is *8192*.

The actions performed are as follows:

* During initialization:

* Gets all *config.xml* parameters, handling the defaults;
* resolves the *&lt;host&gt;* parameter, creating the round-robin IP list;
* connects to CLAMD at the first IP in the round-robin list, on
the specified *&lt;port&gt;*;
* if unsuccessful, retries every *&lt;pingIntervalMilli&gt;* milliseconds up to
*&lt;maxPings&gt;* times;
* sends a *PING* request;
* waits for a *PONG* answer;
* repeats steps 3-6 for every other IP resolved.

* For every mail

* connects to CLAMD at the "next" IP in the round-robin list, on
the specified *&lt;port&gt;*, and increments the "next" index;
if the connection request is not accepted tries with the next one
in the list unless all of them have failed;
* sends a "*STREAM*" request;
* parses the "*PORT *streamPort**" answer obtaining the port number;
* makes a second connection (the *stream connection*) to CLAMD at the same host (or IP)
on the *streamPort* just obtained;
* sends the mime message to CLAMD (using {@link MimeMessage#writeTo(java.io.OutputStream)})
through the *stream connection*;
* closes the *stream connection*;
* gets the "*OK*" or "*... FOUND*" answer from the main connection;
* closes the main connection;
* sets the "*org.apache.james.infected*" *mail attribute* to either
"*true*" or "*false*";
* adds the "*X-MessageIsInfected*" *header* to either
"*true*" or "*false*";

Some notes regarding http://www.clamav.net/[clamav.conf] :

* *LocalSocket* must be commented out
* *TCPSocket* must be set to a port# (typically 3310)
* *StreamMaxLength* must be &gt;= the James config.xml parameter
&lt;*maxmessagesize*&gt; in SMTP &lt;*handler*&gt;
* *MaxThreads* should? be &gt;= the James config.xml parameter
&lt;*threads*&gt; in &lt;*spoolmanager*&gt;
* *ScanMail* must be uncommented

Here follows an example of config.xml definitions deploying CLAMD on localhost,
and handling the infected messages:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;!-- Do an antivirus scan -&#8594;
&lt;mailet match="All" class="ClamAVScan" onMailetException="ignore"/&gt;</p>
</div>
<div class="paragraph">
<p>&lt;!-- If infected go to virus processor -&#8594;
&lt;mailet match="HasMailAttributeWithValue=org.apache.james.infected, true" class="ToProcessor"&gt;
    &lt;processor&gt; virus &lt;/processor&gt;
&lt;/mailet&gt;</p>
</div>
<div class="paragraph">
<p>&lt;!-- Check attachment extensions for possible viruses -&#8594;
&lt;mailet match="AttachmentFileNameIs=-d -z *.exe *.com *.bat *.cmd *.pif *.scr *.vbs *.avi *.mp3 *.mpeg *.shs" class="ToProcessor"&gt;
    &lt;processor&gt; bad-extensions &lt;/processor&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;!-- Messages containing viruses -&#8594;
&lt;processor name="virus"&gt;
  &lt;!-- To avoid a loop while bouncing -&#8594;
  &lt;mailet match="All" class="SetMailAttribute"&gt;
     &lt;org.apache.james.infected&gt;true, bouncing&lt;/org.apache.james.infected&gt;
  &lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="SMTPAuthSuccessful" class="Bounce"&gt;
  &lt;sender&gt;bounce-admin@xxx.com&lt;/sender&gt;
  &lt;inline&gt;heads&lt;/inline&gt;
  &lt;attachment&gt;none&lt;/attachment&gt;
  &lt;notice&gt; Warning: We were unable to deliver the message below because it was found infected by virus(es). &lt;/notice&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="ToRepository"&gt;
  &lt;repositoryPath&gt;file://var/mail/infected/&lt;/repositoryPath&gt;
&lt;/mailet&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  &lt;mailet match="All" class="Null" /&gt;
&lt;/processor&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ClassifyBounce

Assesses the message to determine if it was a hard or soft bounce, and if it was a soft bounce, something of its nature..

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="ClassifyBounce"&gt;
  &lt;headerName&gt;X-MailetHeader&lt;/headerName&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== FromRepository

Re-spools Mail found in the specified Repository.</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="RecipientIs=respool@localhost" class="FromRepository"&gt;
   &lt;repositoryPath&gt; <strong>repository path</strong> &lt;/repositoryPath&gt;
   &lt;processor&gt; <strong>target processor</strong> &lt;/repositoryPath&gt;
   &lt;delete&amp;t; [true|&lt;b&gt;false&lt;/b&gt;] &lt;/delete&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== HeadersToHTTP

Serialise the email and pass it to an HTTP call

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="HeadersToHTTP"&gt;
  &lt;url&gt;<a href="http://192.168.0.252:3000/alarm&lt;/url&gt" class="bare">http://192.168.0.252:3000/alarm&lt;/url&gt</a>;
  &lt;parameterKey&gt;Test&lt;/parameterKey&gt;
  &lt;parameterValue&gt;ParameterValue&lt;/parameterValue&gt;
  &lt;passThrough&gt;true&lt;/passThrough&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== OnlyText

Keep only the text part of a message.

If the message is text only then it doesn't touch it, if it is a multipart it
transform it a in plain text message with the first text part found.

 * text/plain
 * text/html =&gt; with a conversion to text only
 *  text/* as is.

=== Manage Sieve scripts via a mailet

Each user can manage his SIEVE scripts through the `ManageSieveMailet` mailet.

To use the manage SIEVE mailet :

* You need to create the user sievemanager@DOMAIN ( if you don't, the SMTP server will check the domain, recognize it, and look for an absent local user, and will generate an error ).
* You can send Manage Sieve commands by mail to sievemanager@DOMAIN. Your subject must contain the command. Scripts need to be added as attachments and need the ".sieve" extension.

To activate a script for a user, you need the following combination :

* PUTSCRIPT scriptname
* SETACTIVE scriptname

=== RecoverAttachment

This mailet takes an attachment stored in an attribute and attach it back to
the message

This may be used to place back attachment stripped by StripAttachment and
stored in the attribute
*org.apache.james.mailet.standard.mailets.StripAttachment.saved*</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;mailet match="All" class="RecoverAttachment" &gt;
  &lt;attribute&gt;my.attribute.name&lt;/attribute&gt;
&lt;/mailet &gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>=== SerialiseToHTTP

Serialise the email and pass it to an HTTP call

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="SerialiseToHTTP"&gt;
        &lt;name&gt;URL&lt;/name&gt; &lt;value&gt;url where serialised message will be posted&lt;/value&gt;
        &lt;name&gt;ParameterKey&lt;/name&gt; &lt;value&gt;An arbitrary parameter be added to the post&lt;/value&gt;
        &lt;name&gt;ParameterValue&lt;/name&gt; &lt;value&gt;A value for the arbitrary parameter&lt;/value&gt;
        &lt;name&gt;MessageKeyName&lt;/name&gt; &lt;value&gt;Field name for the serialised message&lt;/value&gt;
        &lt;name&gt;passThrough&lt;/name&gt; &lt;value&gt;true or false&lt;/value&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ServerTime

Returns the current time for the mail server.

Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="RecipientIs=<a href="mailto:time@cadenza.lokitech.com">time@cadenza.lokitech.com</a>" class="ServerTime"/&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== SPF

Check the ip, sender, helo against SPF. Add the following attributes to the
mail object:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>org.apache.james.transport.mailets.spf.explanation
org.apache.james.transport.mailets.spf.result</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Sample configuration:</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="All" class="SPF"&gt;
  &lt;addHeader&gt;true&lt;/addHeader&gt;
  &lt;debug&gt;false&lt;/debug&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== ToPlainText

This mailet converts HTML parts of a message into Plain text.

It starts looking for multipart/alternative containing a text/plain and a text/html part
and only keep the text/plain part. Then in a second pass replaces remaining text/html by
their textual content, infered by parsing the HTML content and handling common tags.

Eg:

----
&lt;mailet matcher="All" class="ToPlainText"/&gt;
----

=== ToSenderFolder

 Receives a Mail from the Queue and takes care to deliver the message
  to a defined folder of the sender.

You have to define the folder name of the sender.

The flag 'consume' will tell is the mail will be further

processed by the upcoming processor mailets, or not.</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="RecipientIsLocal" class="ToSenderFolder"&gt;
  &lt;folder&gt; <strong>Sent Items</strong> &lt;/folder&gt;
  &lt;consume&gt; <strong>false</strong> &lt;/consume&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== UnwrapText

Remove (best effort to) the hardcoded wrapping from a message.

If the text is  "format=flowed" then deflows the text. Otherwise it forces a dewrap of the text.


Parameters:

* quotewidth - when we try to dewrap e quoted text it helps knowing the original
with, so we can reconstruct "wrapped wraps" created by multiple wrappings by clients with
different original width or simply to the add of the heading "&gt;" that increase the line
length.

The value should be "WIDTH+X" if the original length is known, "-X" otherwise.

In the latter case the length of the longer line will be used.

X is the tollerance needed for the quoting chars: if the original width is known the suggested
value for X is 2 (because of "&gt; " prefix), otherwise it is suggested to increase it to a value
like 10 (-10)

In summary, if the original wrap is known (for example 76, for flowed messages) *quotewidth = 78*

Otherwise *quotewidth = -10*



=== UseHeaderRecipients

Mailet designed to process the recipients from the mail headers rather
than the recipients specified in the SMTP message header.  This can be
useful if your mail is redirected on-route by a mail server that
substitutes a fixed recipient address for the original.


To use this, match against the redirection address using the
*RecipientIs* matcher and set the mailet 'class' to
*UseHeaderRecipients*.  This will cause the email to be
re-injected into the root process with the recipient substituted
by all the recipients in the Mail-For, To and Cc headers
of the message.

e.g.</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;mailet match="RecipientIs=forwarded@myhost" class="UseHeaderRecipients"&gt;
&lt;/mailet&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>=== WrapText

Convert a message to format=flowed</pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../../_/js/site.js" data-ui-root-path="../../../../../_"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>